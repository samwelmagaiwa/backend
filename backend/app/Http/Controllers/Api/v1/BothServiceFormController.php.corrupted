{"type":"begin","data":{"path":{"text":"backend\\test_both_service_form.php"}}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    // Get or create a department\n"},"line_number":30,"absolute_offset":744,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    $department = Department::first();\n"},"line_number":31,"absolute_offset":778,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    if (!$department) {\n"},"line_number":32,"absolute_offset":817,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        $department = Department::create([\n"},"line_number":33,"absolute_offset":841,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            'name' => 'Test Department',\n"},"line_number":34,"absolute_offset":884,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            'code' => 'TEST',\n"},"line_number":35,"absolute_offset":925,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            'status' => 1\n"},"line_number":36,"absolute_offset":955,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        ]);\n"},"line_number":37,"absolute_offset":981,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    }\n"},"line_number":38,"absolute_offset":993,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":39,"absolute_offset":999,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"🏢 Department: {$department->name} (ID: {$department->id})\\n\\n\";\n"},"line_number":40,"absolute_offset":1004,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":41,"absolute_offset":1081,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    // Get some test modules\n"},"line_number":42,"absolute_offset":1086,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    $wellsoftModules = WellsoftModule::where('is_active', true)->limit(3)->pluck('name')->toArray();\n"},"line_number":43,"absolute_offset":1115,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    $jeevaModules = JeevaModule::where('is_active', true)->limit(2)->pluck('name')->toArray();\n"},"line_number":44,"absolute_offset":1216,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":45,"absolute_offset":1311,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"📋 Selected Wellsoft modules: \" . implode(', ', $wellsoftModules) . \"\\n\";\n"},"line_number":46,"absolute_offset":1316,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"📋 Selected Jeeva modules: \" . implode(', ', $jeevaModules) . \"\\n\\n\";\n"},"line_number":47,"absolute_offset":1402,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":48,"absolute_offset":1484,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    // Start a database transaction\n"},"line_number":49,"absolute_offset":1489,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    DB::beginTransaction();\n"},"line_number":50,"absolute_offset":1525,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":51,"absolute_offset":1553,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"💾 Creating UserAccess record...\\n\";\n"},"line_number":52,"absolute_offset":1558,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":53,"absolute_offset":1607,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    // Create a test UserAccess record\n"},"line_number":54,"absolute_offset":1612,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    $userAccess = UserAccess::create([\n"},"line_number":55,"absolute_offset":1651,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'user_id' => $user->id,\n"},"line_number":56,"absolute_offset":1690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'pf_number' => $user->pf_number ?? 'TEST001',\n"},"line_number":57,"absolute_offset":1722,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'staff_name' => $user->name,\n"},"line_number":58,"absolute_offset":1776,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'phone_number' => '0712345678',\n"},"line_number":59,"absolute_offset":1813,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'department_id' => $department->id,\n"},"line_number":60,"absolute_offset":1853,"submatches":[{"match":{"text":"department_id' ="},"start":9,"end":25}]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'signature_path' => 'test/signature.png',\n"},"line_number":61,"absolute_offset":1897,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'request_type' => ['wellsoft', 'jeeva_access'],\n"},"line_number":62,"absolute_offset":1947,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'status' => 'pending',\n"},"line_number":63,"absolute_offset":2003,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'wellsoft_modules' => $wellsoftModules,\n"},"line_number":64,"absolute_offset":2034,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'wellsoft_modules_selected' => $wellsoftModules,\n"},"line_number":65,"absolute_offset":2082,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'jeeva_modules' => $jeevaModules,\n"},"line_number":66,"absolute_offset":2139,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'jeeva_modules_selected' => $jeevaModules,\n"},"line_number":67,"absolute_offset":2181,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'module_requested_for' => 'use',\n"},"line_number":68,"absolute_offset":2232,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        'access_type' => 'permanent',\n"},"line_number":69,"absolute_offset":2273,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    ]);\n"},"line_number":70,"absolute_offset":2311,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":71,"absolute_offset":2319,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"✅ UserAccess created with ID: {$userAccess->id}\\n\\n\";\n"},"line_number":72,"absolute_offset":2324,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    \n"},"line_number":73,"absolute_offset":2390,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    // Now simulate the FIXED code - save to relationship tables\n"},"line_number":74,"absolute_offset":2395,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    echo \"💾 Saving Wellsoft modules to relationship table...\\n\";\n"},"line_number":75,"absolute_offset":2460,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"    foreach ($wellsoftModules as $moduleName) {\n"},"line_number":76,"absolute_offset":2528,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        $wellsoftModule = WellsoftModule::where('name', $moduleName)\n"},"line_number":77,"absolute_offset":2576,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            ->where('is_active', true)\n"},"line_number":78,"absolute_offset":2645,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            ->first();\n"},"line_number":79,"absolute_offset":2684,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        \n"},"line_number":80,"absolute_offset":2707,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        if ($wellsoftModule) {\n"},"line_number":81,"absolute_offset":2716,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            DB::table('wellsoft_modules_selected')->insert([\n"},"line_number":82,"absolute_offset":2747,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"                'user_access_id' => $userAccess->id,\n"},"line_number":83,"absolute_offset":2808,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"                'module_id' => $wellsoftModule->id,\n"},"line_number":84,"absolute_offset":2861,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"                'created_at' => now(),\n"},"line_number":85,"absolute_offset":2913,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"                'updated_at' => now()\n"},"line_number":86,"absolute_offset":2952,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            ]);\n"},"line_number":87,"absolute_offset":2990,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            \n"},"line_number":88,"absolute_offset":3006,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"            echo \"  ✅ Added: {$moduleName} (ID: {$wellsoftModule->id})\\n\";\n"},"line_number":89,"absolute_offset":3019,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\test_both_service_form.php"},"lines":{"text":"        } else {\n"},"line_number":90,"absolute_offset":3096,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\test_both_service_form.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":534700,"human":"0.000535s"},"searches":1,"searches_with_match":1,"bytes_searched":6473,"bytes_printed":12220,"matched_lines":1,"matches":1}}}
{"type":"begin","data":{"path":{"text":"backend\\routes\\api.php"}}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":78,"absolute_offset":2892,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"// Security Test Routes (for testing security implementations)\n"},"line_number":79,"absolute_offset":2893,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"Route::prefix('security-test')->group(function () {\n"},"line_number":80,"absolute_offset":2956,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::get('/test', [SecurityTestController::class, 'test'])->name('security-test.basic');\n"},"line_number":81,"absolute_offset":3008,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::get('/health', [SecurityTestController::class, 'healthCheck'])->name('security-test.health');\n"},"line_number":82,"absolute_offset":3103,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::get('/rate-limit', [SecurityTestController::class, 'rateLimitTest'])->name('security-test.rate-limit');\n"},"line_number":83,"absolute_offset":3208,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::post('/sanitization', [SecurityTestController::class, 'sanitizationTest'])->name('security-test.sanitization');\n"},"line_number":84,"absolute_offset":3323,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::post('/xss', [SecurityTestController::class, 'xssTest'])->name('security-test.xss');\n"},"line_number":85,"absolute_offset":3446,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"});\n"},"line_number":86,"absolute_offset":3542,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":87,"absolute_offset":3546,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"// Protected routes\n"},"line_number":88,"absolute_offset":3547,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"Route::middleware('auth:sanctum')->group(function () {\n"},"line_number":89,"absolute_offset":3567,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::get('/user', function (Request $request) {\n"},"line_number":90,"absolute_offset":3622,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        $user = $request->user();\n"},"line_number":91,"absolute_offset":3676,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":92,"absolute_offset":3710,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        // Load the roles relationship (new system)\n"},"line_number":93,"absolute_offset":3711,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        $user->load('roles', 'department');\n"},"line_number":94,"absolute_offset":3763,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":95,"absolute_offset":3807,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        // Get primary role for consistent role handling\n"},"line_number":96,"absolute_offset":3808,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        $primaryRole = $user->getPrimaryRoleName();\n"},"line_number":97,"absolute_offset":3865,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        $userRoles = $user->roles->pluck('name')->toArray();\n"},"line_number":98,"absolute_offset":3917,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":99,"absolute_offset":3978,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        // Return user with role information using new system\n"},"line_number":100,"absolute_offset":3979,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        return [\n"},"line_number":101,"absolute_offset":4041,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'id' => $user->id,\n"},"line_number":102,"absolute_offset":4058,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'name' => $user->name,\n"},"line_number":103,"absolute_offset":4089,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'email' => $user->email,\n"},"line_number":104,"absolute_offset":4124,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'phone' => $user->phone,\n"},"line_number":105,"absolute_offset":4161,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'pf_number' => $user->pf_number,\n"},"line_number":106,"absolute_offset":4198,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'staff_name' => $user->staff_name,\n"},"line_number":107,"absolute_offset":4243,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'department_id' => $user->department_id,\n"},"line_number":108,"absolute_offset":4290,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'department' => $user->department ? [\n"},"line_number":109,"absolute_offset":4343,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                'id' => $user->department->id,\n"},"line_number":110,"absolute_offset":4393,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                'name' => $user->department->name,\n"},"line_number":111,"absolute_offset":4440,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                'code' => $user->department->code,\n"},"line_number":112,"absolute_offset":4491,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                'display_name' => $user->department->getFullNameAttribute()\n"},"line_number":113,"absolute_offset":4542,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            ] : null,\n"},"line_number":114,"absolute_offset":4618,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'is_active' => $user->is_active ?? true,\n"},"line_number":115,"absolute_offset":4640,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'role' => $primaryRole, // Normalized role field\n"},"line_number":116,"absolute_offset":4693,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'role_name' => $primaryRole, // For backward compatibility\n"},"line_number":117,"absolute_offset":4754,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'primary_role' => $primaryRole, // Explicit primary role\n"},"line_number":118,"absolute_offset":4825,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'roles' => $userRoles, // Array of role names\n"},"line_number":119,"absolute_offset":4894,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'role_objects' => $user->roles->map(function ($role) {\n"},"line_number":120,"absolute_offset":4952,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                return [\n"},"line_number":121,"absolute_offset":5019,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                    'id' => $role->id,\n"},"line_number":122,"absolute_offset":5044,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                    'name' => $role->name,\n"},"line_number":123,"absolute_offset":5083,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                    'display_name' => ucwords(str_replace('_', ' ', $role->name))\n"},"line_number":124,"absolute_offset":5126,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"                ];\n"},"line_number":125,"absolute_offset":5208,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            }),\n"},"line_number":126,"absolute_offset":5227,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'display_roles' => $user->getDisplayRoleNames(),\n"},"line_number":127,"absolute_offset":5243,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'permissions' => $user->getAllPermissions(),\n"},"line_number":128,"absolute_offset":5304,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'needs_onboarding' => $user->needsOnboarding(),\n"},"line_number":129,"absolute_offset":5361,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'created_at' => $user->created_at,\n"},"line_number":130,"absolute_offset":5421,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"            'updated_at' => $user->updated_at,\n"},"line_number":131,"absolute_offset":5468,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"        ];\n"},"line_number":132,"absolute_offset":5515,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    });\n"},"line_number":133,"absolute_offset":5526,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"\n"},"line_number":134,"absolute_offset":5534,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    // Authentication routes\n"},"line_number":135,"absolute_offset":5535,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::post('/logout', [AuthController::class, 'logout'])->middleware('throttle:sensitive')->name('logout');\n"},"line_number":136,"absolute_offset":5564,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::post('/logout-all', [AuthController::class, 'logoutAll'])->middleware('throttle:sensitive')->name('logout-all');\n"},"line_number":137,"absolute_offset":5677,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\routes\\api.php"},"lines":{"text":"    Route::get('/sessions', [AuthController::class, 'getActiveSessions'])->middleware('throttle:api')->name('sessions');\n"},"line_number":138,"absolute_offset":5801,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\routes\\api.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":750100,"human":"0.000750s"},"searches":1,"searches_with_match":1,"bytes_searched":37590,"bytes_printed":12221,"matched_lines":1,"matches":1}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\OpenApi.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"name\", type=\"string\", example=\"admin\"),\n"},"line_number":44,"absolute_offset":850,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"description\", type=\"string\", nullable=true),\n"},"line_number":45,"absolute_offset":918,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"is_system_role\", type=\"boolean\", example=true)\n"},"line_number":46,"absolute_offset":991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":47,"absolute_offset":1066,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":48,"absolute_offset":1071,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class RoleSchema {}\n"},"line_number":49,"absolute_offset":1075,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":50,"absolute_offset":1095,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":51,"absolute_offset":1096,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":52,"absolute_offset":1100,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"Department\",\n"},"line_number":53,"absolute_offset":1115,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":54,"absolute_offset":1141,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"id\", type=\"integer\"),\n"},"line_number":55,"absolute_offset":1161,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"name\", type=\"string\"),\n"},"line_number":56,"absolute_offset":1211,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"code\", type=\"string\", nullable=true),\n"},"line_number":57,"absolute_offset":1262,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"description\", type=\"string\", nullable=true),\n"},"line_number":58,"absolute_offset":1328,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"is_active\", type=\"boolean\")\n"},"line_number":59,"absolute_offset":1401,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":60,"absolute_offset":1457,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":61,"absolute_offset":1462,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class DepartmentSchema {}\n"},"line_number":62,"absolute_offset":1466,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":63,"absolute_offset":1492,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":64,"absolute_offset":1493,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":65,"absolute_offset":1497,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"User\",\n"},"line_number":66,"absolute_offset":1512,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":67,"absolute_offset":1532,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"id\", type=\"integer\"),\n"},"line_number":68,"absolute_offset":1552,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"name\", type=\"string\"),\n"},"line_number":69,"absolute_offset":1602,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"email\", type=\"string\"),\n"},"line_number":70,"absolute_offset":1653,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"phone\", type=\"string\", nullable=true),\n"},"line_number":71,"absolute_offset":1705,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"pf_number\", type=\"string\", nullable=true),\n"},"line_number":72,"absolute_offset":1772,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"staff_name\", type=\"string\", nullable=true),\n"},"line_number":73,"absolute_offset":1843,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"department_id\", type=\"integer\", nullable=true),\n"},"line_number":74,"absolute_offset":1915,"submatches":[{"match":{"text":"department_id\", type=\"integer\", nullable="},"start":28,"end":69}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"is_active\", type=\"boolean\"),\n"},"line_number":75,"absolute_offset":1991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"role\", type=\"string\", description=\"Primary role name (derived)\", example=\"staff\"),\n"},"line_number":76,"absolute_offset":2048,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"roles\", type=\"array\", @OA\\Items(type=\"string\")),\n"},"line_number":77,"absolute_offset":2159,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"permissions\", type=\"array\", @OA\\Items(type=\"string\")),\n"},"line_number":78,"absolute_offset":2236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"created_at\", type=\"string\", format=\"date-time\"),\n"},"line_number":79,"absolute_offset":2319,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"updated_at\", type=\"string\", format=\"date-time\"),\n"},"line_number":80,"absolute_offset":2396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"department\", ref=\"#/components/schemas/Department\", nullable=true)\n"},"line_number":81,"absolute_offset":2473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":82,"absolute_offset":2568,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":83,"absolute_offset":2573,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class UserSchema {}\n"},"line_number":84,"absolute_offset":2577,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":85,"absolute_offset":2597,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":86,"absolute_offset":2598,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":87,"absolute_offset":2602,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"LoginRequest\",\n"},"line_number":88,"absolute_offset":2617,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":89,"absolute_offset":2645,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   required={\"email\",\"password\"},\n"},"line_number":90,"absolute_offset":2665,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"email\", type=\"string\", example=\"admin@mnh.go.tz\"),\n"},"line_number":91,"absolute_offset":2701,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"password\", type=\"string\", example=\"12345678\")\n"},"line_number":92,"absolute_offset":2780,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":93,"absolute_offset":2854,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":94,"absolute_offset":2859,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class LoginRequest {}\n"},"line_number":95,"absolute_offset":2863,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":96,"absolute_offset":2885,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":97,"absolute_offset":2886,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":98,"absolute_offset":2890,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"LoginResponse\",\n"},"line_number":99,"absolute_offset":2905,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":100,"absolute_offset":2934,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"user\", ref=\"#/components/schemas/User\"),\n"},"line_number":101,"absolute_offset":2954,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"token\", type=\"string\"),\n"},"line_number":102,"absolute_offset":3023,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"token_name\", type=\"string\")\n"},"line_number":103,"absolute_offset":3075,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":104,"absolute_offset":3131,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":105,"absolute_offset":3136,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class LoginResponse {}\n"},"line_number":106,"absolute_offset":3140,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":107,"absolute_offset":3163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":108,"absolute_offset":3164,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":109,"absolute_offset":3168,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"CreateUserRequest\",\n"},"line_number":110,"absolute_offset":3183,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":111,"absolute_offset":3216,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   required={\"name\",\"email\",\"password\",\"password_confirmation\",\"role_ids\"},\n"},"line_number":112,"absolute_offset":3236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"name\", type=\"string\"),\n"},"line_number":113,"absolute_offset":3314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"email\", type=\"string\"),\n"},"line_number":114,"absolute_offset":3365,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"password\", type=\"string\"),\n"},"line_number":115,"absolute_offset":3417,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"password_confirmation\", type=\"string\"),\n"},"line_number":116,"absolute_offset":3472,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"phone\", type=\"string\", nullable=true),\n"},"line_number":117,"absolute_offset":3540,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"pf_number\", type=\"string\", nullable=true),\n"},"line_number":118,"absolute_offset":3607,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"staff_name\", type=\"string\", nullable=true),\n"},"line_number":119,"absolute_offset":3678,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"department_id\", type=\"integer\", nullable=true),\n"},"line_number":120,"absolute_offset":3750,"submatches":[{"match":{"text":"department_id\", type=\"integer\", nullable="},"start":28,"end":69}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"is_active\", type=\"boolean\", default=true),\n"},"line_number":121,"absolute_offset":3826,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"role_ids\", type=\"array\", @OA\\Items(type=\"integer\"))\n"},"line_number":122,"absolute_offset":3897,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":123,"absolute_offset":3977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":124,"absolute_offset":3982,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class CreateUserRequest {}\n"},"line_number":125,"absolute_offset":3986,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":126,"absolute_offset":4013,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":127,"absolute_offset":4014,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":128,"absolute_offset":4018,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"AssignRolesRequest\",\n"},"line_number":129,"absolute_offset":4033,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":130,"absolute_offset":4067,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   required={\"role_ids\"},\n"},"line_number":131,"absolute_offset":4087,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"role_ids\", type=\"array\", @OA\\Items(type=\"integer\"))\n"},"line_number":132,"absolute_offset":4115,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":133,"absolute_offset":4195,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":134,"absolute_offset":4200,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class AssignRolesRequest {}\n"},"line_number":135,"absolute_offset":4204,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":136,"absolute_offset":4232,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":137,"absolute_offset":4233,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Schema(\n"},"line_number":138,"absolute_offset":4237,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   schema=\"RevokeSessionRequest\",\n"},"line_number":139,"absolute_offset":4252,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   type=\"object\",\n"},"line_number":140,"absolute_offset":4288,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   required={\"token_id\"},\n"},"line_number":141,"absolute_offset":4308,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" *   @OA\\Property(property=\"token_id\", type=\"integer\", example=1)\n"},"line_number":142,"absolute_offset":4336,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * )\n"},"line_number":143,"absolute_offset":4402,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" */\n"},"line_number":144,"absolute_offset":4407,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"class RevokeSessionRequest {}\n"},"line_number":145,"absolute_offset":4411,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"\n"},"line_number":146,"absolute_offset":4441,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":"/**\n"},"line_number":147,"absolute_offset":4442,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * Tags\n"},"line_number":148,"absolute_offset":4446,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Tag(name=\"Health\", description=\"Health checks\")\n"},"line_number":149,"absolute_offset":4454,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\OpenApi.php"},"lines":{"text":" * @OA\\Tag(name=\"Auth\", description=\"Authentication endpoints\")\n"},"line_number":150,"absolute_offset":4509,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\OpenApi.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":182900,"human":"0.000183s"},"searches":1,"searches_with_match":1,"bytes_searched":13934,"bytes_printed":20234,"matched_lines":2,"matches":2}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        \n"},"line_number":291,"absolute_offset":10380,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        // DEPARTMENT FILTERING: HODs only see statistics from their department(s)\n"},"line_number":292,"absolute_offset":10389,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        if ($user->hasRole('head_of_department')) {\n"},"line_number":293,"absolute_offset":10472,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            $hodDepartmentIds = $user->departmentsAsHOD()->pluck('id')->toArray();\n"},"line_number":294,"absolute_offset":10524,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            if (!empty($hodDepartmentIds)) {\n"},"line_number":295,"absolute_offset":10607,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"                $baseQuery->whereIn('department_id', $hodDepartmentIds);\n"},"line_number":296,"absolute_offset":10652,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            } else {\n"},"line_number":297,"absolute_offset":10725,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"                // If user has HOD role but no departments assigned, show zero stats\n"},"line_number":298,"absolute_offset":10746,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"                $baseQuery->whereRaw('1 = 0');\n"},"line_number":299,"absolute_offset":10831,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            }\n"},"line_number":300,"absolute_offset":10878,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        }\n"},"line_number":301,"absolute_offset":10892,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"\n"},"line_number":302,"absolute_offset":10902,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        return [\n"},"line_number":303,"absolute_offset":10903,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'total' => $baseQuery->count(),\n"},"line_number":304,"absolute_offset":10920,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'pending' => (clone $baseQuery)->where('status', 'like', 'pending%')->count(),\n"},"line_number":305,"absolute_offset":10964,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'approved' => (clone $baseQuery)->whereIn('status', ['approved', 'implemented'])->count(),\n"},"line_number":306,"absolute_offset":11055,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'rejected' => (clone $baseQuery)->where('status', 'like', '%rejected')->count(),\n"},"line_number":307,"absolute_offset":11158,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'cancelled' => (clone $baseQuery)->where('status', 'cancelled')->count(),\n"},"line_number":308,"absolute_offset":11251,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        ];\n"},"line_number":309,"absolute_offset":11337,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    }\n"},"line_number":310,"absolute_offset":11348,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"\n"},"line_number":311,"absolute_offset":11354,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    /**\n"},"line_number":312,"absolute_offset":11355,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     * Validate and prepare request data\n"},"line_number":313,"absolute_offset":11363,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     */\n"},"line_number":314,"absolute_offset":11404,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    private function validateAndPrepareRequestData(Request $request): array\n"},"line_number":315,"absolute_offset":11412,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    {\n"},"line_number":316,"absolute_offset":11488,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        $request->validate([\n"},"line_number":317,"absolute_offset":11494,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'pf_number' => 'required|string|max:50',\n"},"line_number":318,"absolute_offset":11523,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'staff_name' => 'required|string|max:255',\n"},"line_number":319,"absolute_offset":11576,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'phone_number' => 'nullable|string|max:20',\n"},"line_number":320,"absolute_offset":11631,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'department_id' => 'required|exists:departments,id',\n"},"line_number":321,"absolute_offset":11687,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'request_type' => 'required|array',\n"},"line_number":322,"absolute_offset":11752,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'request_type.*' => 'in:jeeva_access,wellsoft,internet_access_request',\n"},"line_number":323,"absolute_offset":11800,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'wellsoft_modules' => 'nullable|array',\n"},"line_number":324,"absolute_offset":11884,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'jeeva_modules' => 'nullable|array',\n"},"line_number":325,"absolute_offset":11936,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'internet_purposes' => 'nullable|array',\n"},"line_number":326,"absolute_offset":11985,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'access_type' => 'required|in:permanent,temporary',\n"},"line_number":327,"absolute_offset":12038,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'temporary_until' => 'required_if:access_type,temporary|nullable|date|after:today',\n"},"line_number":328,"absolute_offset":12102,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        ]);\n"},"line_number":329,"absolute_offset":12198,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"\n"},"line_number":330,"absolute_offset":12210,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        return [\n"},"line_number":331,"absolute_offset":12211,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'user_id' => auth()->id(),\n"},"line_number":332,"absolute_offset":12228,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'pf_number' => $request->pf_number,\n"},"line_number":333,"absolute_offset":12267,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'staff_name' => $request->staff_name,\n"},"line_number":334,"absolute_offset":12315,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'phone_number' => $request->phone_number,\n"},"line_number":335,"absolute_offset":12365,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'department_id' => $request->department_id,\n"},"line_number":336,"absolute_offset":12419,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'request_type' => $request->request_type,\n"},"line_number":337,"absolute_offset":12475,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'wellsoft_modules' => $request->wellsoft_modules,\n"},"line_number":338,"absolute_offset":12529,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'jeeva_modules' => $request->jeeva_modules,\n"},"line_number":339,"absolute_offset":12591,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'internet_purposes' => $request->internet_purposes,\n"},"line_number":340,"absolute_offset":12647,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'access_type' => $request->access_type,\n"},"line_number":341,"absolute_offset":12711,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'temporary_until' => $request->temporary_until,\n"},"line_number":342,"absolute_offset":12763,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            'status' => 'pending_hod',\n"},"line_number":343,"absolute_offset":12823,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        ];\n"},"line_number":344,"absolute_offset":12862,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    }\n"},"line_number":345,"absolute_offset":12873,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"\n"},"line_number":346,"absolute_offset":12879,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    /**\n"},"line_number":347,"absolute_offset":12880,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     * Handle signature file upload\n"},"line_number":348,"absolute_offset":12888,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     */\n"},"line_number":349,"absolute_offset":12924,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    private function handleSignatureUpload($file, string $prefix): string\n"},"line_number":350,"absolute_offset":12932,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    {\n"},"line_number":351,"absolute_offset":13006,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        $timestamp = time();\n"},"line_number":352,"absolute_offset":13012,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        $extension = $file->getClientOriginalExtension();\n"},"line_number":353,"absolute_offset":13041,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        $filename = \"signature_{$timestamp}.{$extension}\";\n"},"line_number":354,"absolute_offset":13099,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        $path = \"signatures/{$prefix}\";\n"},"line_number":355,"absolute_offset":13158,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        \n"},"line_number":356,"absolute_offset":13198,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        return $file->storeAs($path, $filename, 'public');\n"},"line_number":357,"absolute_offset":13207,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    }\n"},"line_number":358,"absolute_offset":13266,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"\n"},"line_number":359,"absolute_offset":13272,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    /**\n"},"line_number":360,"absolute_offset":13273,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     * Get allowed statuses based on user role\n"},"line_number":361,"absolute_offset":13281,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"     */\n"},"line_number":362,"absolute_offset":13328,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    private function getStatusForUserRole(User $user): ?array\n"},"line_number":363,"absolute_offset":13336,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"    {\n"},"line_number":364,"absolute_offset":13398,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"        if (!$user->hasRole()) {\n"},"line_number":365,"absolute_offset":13404,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"lines":{"text":"            return null;\n"},"line_number":366,"absolute_offset":13437,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Services\\UserAccessWorkflowService.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":344500,"human":"0.000345s"},"searches":1,"searches_with_match":1,"bytes_searched":17159,"bytes_printed":16898,"matched_lines":2,"matches":2}}}
{"type":"begin","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"}}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'ADMIN' => Department::where('code', 'ADMIN')->first(),\n"},"line_number":29,"absolute_offset":844,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'NURS' => Department::where('code', 'NURS')->first(),\n"},"line_number":30,"absolute_offset":912,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'LAB' => Department::where('code', 'LAB')->first(),\n"},"line_number":31,"absolute_offset":978,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'PHARM' => Department::where('code', 'PHARM')->first(),\n"},"line_number":32,"absolute_offset":1042,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'MR' => Department::where('code', 'MR')->first(),\n"},"line_number":33,"absolute_offset":1110,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'RAD' => Department::where('code', 'RAD')->first(),\n"},"line_number":34,"absolute_offset":1172,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'ED' => Department::where('code', 'ED')->first(),\n"},"line_number":35,"absolute_offset":1236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'SURG' => Department::where('code', 'SURG')->first(),\n"},"line_number":36,"absolute_offset":1298,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'OPD' => Department::where('code', 'OPD')->first(),\n"},"line_number":37,"absolute_offset":1364,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'FIN' => Department::where('code', 'FIN')->first(),\n"},"line_number":38,"absolute_offset":1428,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        ];\n"},"line_number":39,"absolute_offset":1492,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"\n"},"line_number":40,"absolute_offset":1503,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        // Get roles for assignment\n"},"line_number":41,"absolute_offset":1504,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        $roles = [\n"},"line_number":42,"absolute_offset":1540,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'admin' => Role::where('name', 'admin')->first(),\n"},"line_number":43,"absolute_offset":1559,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'divisional_director' => Role::where('name', 'divisional_director')->first(),\n"},"line_number":44,"absolute_offset":1621,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'head_of_department' => Role::where('name', 'head_of_department')->first(),\n"},"line_number":45,"absolute_offset":1711,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'ict_director' => Role::where('name', 'ict_director')->first(),\n"},"line_number":46,"absolute_offset":1799,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'ict_officer' => Role::where('name', 'ict_officer')->first(),\n"},"line_number":47,"absolute_offset":1875,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            'staff' => Role::where('name', 'staff')->first(),\n"},"line_number":48,"absolute_offset":1949,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        ];\n"},"line_number":49,"absolute_offset":2011,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"\n"},"line_number":50,"absolute_offset":2022,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        // Create users with role assignments\n"},"line_number":51,"absolute_offset":2023,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"        $users = [\n"},"line_number":52,"absolute_offset":2069,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            // Administrative Users\n"},"line_number":53,"absolute_offset":2088,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":54,"absolute_offset":2124,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'System Administrator',\n"},"line_number":55,"absolute_offset":2138,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'admin@mnh.go.tz',\n"},"line_number":56,"absolute_offset":2188,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000000',\n"},"line_number":57,"absolute_offset":2234,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'pf_number' => 'PF2367',\n"},"line_number":58,"absolute_offset":2278,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'department_id' => $departments['ADMIN']?->id,\n"},"line_number":59,"absolute_offset":2319,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'password' => Hash::make('12345678'),\n"},"line_number":60,"absolute_offset":2382,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":61,"absolute_offset":2436,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'roles' => ['admin']\n"},"line_number":62,"absolute_offset":2473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            ],\n"},"line_number":63,"absolute_offset":2510,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            \n"},"line_number":64,"absolute_offset":2525,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            // ICT Department Users\n"},"line_number":65,"absolute_offset":2538,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":66,"absolute_offset":2574,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'ICT Director',\n"},"line_number":67,"absolute_offset":2588,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'ict.director@mnh.go.tz',\n"},"line_number":68,"absolute_offset":2630,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000001',\n"},"line_number":69,"absolute_offset":2683,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'pf_number' => 'PF8901',\n"},"line_number":70,"absolute_offset":2727,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'department_id' => $departments['ICT']?->id,\n"},"line_number":71,"absolute_offset":2768,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'password' => Hash::make('12345678'),\n"},"line_number":72,"absolute_offset":2829,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":73,"absolute_offset":2883,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'roles' => ['ict_director']\n"},"line_number":74,"absolute_offset":2920,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            ],\n"},"line_number":75,"absolute_offset":2964,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":76,"absolute_offset":2979,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'Senior ICT Officer',\n"},"line_number":77,"absolute_offset":2993,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'ict.officer@mnh.go.tz',\n"},"line_number":78,"absolute_offset":3041,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000002',\n"},"line_number":79,"absolute_offset":3093,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'pf_number' => 'PF1289',\n"},"line_number":80,"absolute_offset":3137,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'department_id' => $departments['ICT']?->id,\n"},"line_number":81,"absolute_offset":3178,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'password' => Hash::make('12345678'),\n"},"line_number":82,"absolute_offset":3239,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":83,"absolute_offset":3293,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'roles' => ['ict_officer']\n"},"line_number":84,"absolute_offset":3330,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            ],\n"},"line_number":85,"absolute_offset":3373,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":86,"absolute_offset":3388,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'ICT Support Specialist',\n"},"line_number":87,"absolute_offset":3402,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'ict.support@mnh.go.tz',\n"},"line_number":88,"absolute_offset":3454,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000003',\n"},"line_number":89,"absolute_offset":3506,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'pf_number' => 'PF3456',\n"},"line_number":90,"absolute_offset":3550,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'department_id' => $departments['ICT']?->id,\n"},"line_number":91,"absolute_offset":3591,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'password' => Hash::make('12345678'),\n"},"line_number":92,"absolute_offset":3652,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":93,"absolute_offset":3706,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'roles' => ['staff']\n"},"line_number":94,"absolute_offset":3743,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            ],\n"},"line_number":95,"absolute_offset":3780,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            \n"},"line_number":96,"absolute_offset":3795,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            // HR Department Users\n"},"line_number":97,"absolute_offset":3808,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":98,"absolute_offset":3843,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'HR Director',\n"},"line_number":99,"absolute_offset":3857,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'hr.director@mnh.go.tz',\n"},"line_number":100,"absolute_offset":3898,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000004',\n"},"line_number":101,"absolute_offset":3950,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'pf_number' => 'PF6372',\n"},"line_number":102,"absolute_offset":3994,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'department_id' => $departments['HR']?->id,\n"},"line_number":103,"absolute_offset":4035,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'password' => Hash::make('12345678'),\n"},"line_number":104,"absolute_offset":4095,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":105,"absolute_offset":4149,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'roles' => ['divisional_director']\n"},"line_number":106,"absolute_offset":4186,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            ],\n"},"line_number":107,"absolute_offset":4237,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"            [\n"},"line_number":108,"absolute_offset":4252,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'name' => 'Head of HR Department',\n"},"line_number":109,"absolute_offset":4266,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'email' => 'hod.hr@mnh.go.tz',\n"},"line_number":110,"absolute_offset":4317,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"lines":{"text":"                'phone' => '+255700000005',\n"},"line_number":111,"absolute_offset":4364,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\database\\seeders\\UserSeeder.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":224300,"human":"0.000224s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":17713,"matched_lines":5,"matches":5}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    public function authorize(): bool\n"},"line_number":13,"absolute_offset":241,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    {\n"},"line_number":14,"absolute_offset":279,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        return auth()->check();\n"},"line_number":15,"absolute_offset":285,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    }\n"},"line_number":16,"absolute_offset":317,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":17,"absolute_offset":323,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    /**\n"},"line_number":18,"absolute_offset":324,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     * Get the validation rules that apply to the request.\n"},"line_number":19,"absolute_offset":332,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     */\n"},"line_number":20,"absolute_offset":391,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    public function rules(): array\n"},"line_number":21,"absolute_offset":399,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    {\n"},"line_number":22,"absolute_offset":434,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules = [\n"},"line_number":23,"absolute_offset":440,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'pf_number' => [\n"},"line_number":24,"absolute_offset":459,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":25,"absolute_offset":488,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'string',\n"},"line_number":26,"absolute_offset":516,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'max:50',\n"},"line_number":27,"absolute_offset":542,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'regex:/^[A-Za-z0-9\\-\\/]+$/', // Allow alphanumeric, hyphens, and slashes\n"},"line_number":28,"absolute_offset":568,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":29,"absolute_offset":658,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'staff_name' => [\n"},"line_number":30,"absolute_offset":673,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":31,"absolute_offset":703,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'string',\n"},"line_number":32,"absolute_offset":731,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'max:255',\n"},"line_number":33,"absolute_offset":757,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'regex:/^[a-zA-Z\\s\\.\\-\\']+$/', // Allow letters, spaces, dots, hyphens, apostrophes\n"},"line_number":34,"absolute_offset":784,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":35,"absolute_offset":884,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'phone_number' => [\n"},"line_number":36,"absolute_offset":899,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":37,"absolute_offset":931,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'string',\n"},"line_number":38,"absolute_offset":959,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'regex:/^[\\+]?[0-9\\s\\-\\(\\)]+$/', // Allow international format\n"},"line_number":39,"absolute_offset":985,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'min:10',\n"},"line_number":40,"absolute_offset":1064,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'max:20',\n"},"line_number":41,"absolute_offset":1090,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":42,"absolute_offset":1116,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'department_id' => [\n"},"line_number":43,"absolute_offset":1131,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":44,"absolute_offset":1164,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'integer',\n"},"line_number":45,"absolute_offset":1192,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'exists:departments,id',\n"},"line_number":46,"absolute_offset":1219,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":47,"absolute_offset":1260,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'signature' => [\n"},"line_number":48,"absolute_offset":1275,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":49,"absolute_offset":1304,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'file',\n"},"line_number":50,"absolute_offset":1332,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'mimes:png,jpg,jpeg',\n"},"line_number":51,"absolute_offset":1356,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'max:5120', // 5MB max\n"},"line_number":52,"absolute_offset":1394,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":53,"absolute_offset":1433,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type' => [\n"},"line_number":54,"absolute_offset":1448,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":55,"absolute_offset":1480,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'array',\n"},"line_number":56,"absolute_offset":1508,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'min:1',\n"},"line_number":57,"absolute_offset":1533,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":58,"absolute_offset":1558,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type.*' => [\n"},"line_number":59,"absolute_offset":1573,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'required',\n"},"line_number":60,"absolute_offset":1607,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'string',\n"},"line_number":61,"absolute_offset":1635,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"                'in:jeeva_access,wellsoft,internet_access_request',\n"},"line_number":62,"absolute_offset":1661,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            ],\n"},"line_number":63,"absolute_offset":1729,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        ];\n"},"line_number":64,"absolute_offset":1744,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":65,"absolute_offset":1755,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        // Internet purposes validation will be handled in withValidator method\n"},"line_number":66,"absolute_offset":1756,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        // after prepareForValidation has run\n"},"line_number":67,"absolute_offset":1836,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['internetPurposes'] = [\n"},"line_number":68,"absolute_offset":1882,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'nullable',\n"},"line_number":69,"absolute_offset":1921,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'array',\n"},"line_number":70,"absolute_offset":1945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'max:4',\n"},"line_number":71,"absolute_offset":1966,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        ];\n"},"line_number":72,"absolute_offset":1987,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['internetPurposes.*'] = [\n"},"line_number":73,"absolute_offset":1998,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['ictDirectorComments'] = ['nullable', 'string', 'max:1000'];\n"},"line_number":104,"absolute_offset":3622,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        \n"},"line_number":105,"absolute_offset":3698,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        // \\u2705 ADD IMPLEMENTATION DATA VALIDATION RULES\n"},"line_number":106,"absolute_offset":3707,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['headITName'] = ['nullable', 'string', 'max:255'];\n"},"line_number":107,"absolute_offset":3766,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['headITSignature'] = ['nullable', 'file', 'mimes:png,jpg,jpeg', 'max:5120'];\n"},"line_number":108,"absolute_offset":3832,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['headITDate'] = ['nullable', 'date'];\n"},"line_number":109,"absolute_offset":3924,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['headITComments'] = ['nullable', 'string', 'max:1000'];\n"},"line_number":110,"absolute_offset":3977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        \n"},"line_number":111,"absolute_offset":4048,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['ictOfficerName'] = ['nullable', 'string', 'max:255'];\n"},"line_number":112,"absolute_offset":4057,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['ictOfficerSignature'] = ['nullable', 'file', 'mimes:png,jpg,jpeg', 'max:5120'];\n"},"line_number":113,"absolute_offset":4127,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['ictOfficerDate'] = ['nullable', 'date'];\n"},"line_number":114,"absolute_offset":4223,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['ictOfficerComments'] = ['nullable', 'string', 'max:1000'];\n"},"line_number":115,"absolute_offset":4280,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        $rules['implementationComments'] = ['nullable', 'string', 'max:1000'];\n"},"line_number":116,"absolute_offset":4355,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":117,"absolute_offset":4434,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        return $rules;\n"},"line_number":118,"absolute_offset":4435,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    }\n"},"line_number":119,"absolute_offset":4458,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":120,"absolute_offset":4464,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    /**\n"},"line_number":121,"absolute_offset":4465,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     * Get custom error messages for validator errors.\n"},"line_number":122,"absolute_offset":4473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     */\n"},"line_number":123,"absolute_offset":4528,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    public function messages(): array\n"},"line_number":124,"absolute_offset":4536,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    {\n"},"line_number":125,"absolute_offset":4574,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        return [\n"},"line_number":126,"absolute_offset":4580,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'pf_number.required' => 'PF Number is required.',\n"},"line_number":127,"absolute_offset":4597,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'pf_number.regex' => 'PF Number format is invalid.',\n"},"line_number":128,"absolute_offset":4659,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'staff_name.required' => 'Staff name is required.',\n"},"line_number":129,"absolute_offset":4724,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'staff_name.regex' => 'Staff name contains invalid characters.',\n"},"line_number":130,"absolute_offset":4788,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'phone_number.required' => 'Phone number is required.',\n"},"line_number":131,"absolute_offset":4865,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'phone_number.regex' => 'Phone number format is invalid.',\n"},"line_number":132,"absolute_offset":4933,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'phone_number.min' => 'Phone number must be at least 10 digits.',\n"},"line_number":133,"absolute_offset":5004,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'department_id.required' => 'Department selection is required.',\n"},"line_number":134,"absolute_offset":5082,"submatches":[{"match":{"text":"department_id.required' ="},"start":13,"end":38}]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'department_id.exists' => 'Selected department does not exist.',\n"},"line_number":135,"absolute_offset":5159,"submatches":[{"match":{"text":"department_id.exists' ="},"start":13,"end":36}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'signature.required' => 'Digital signature is required.',\n"},"line_number":136,"absolute_offset":5236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'signature.mimes' => 'Digital signature must be a PNG, JPG, or JPEG file.',\n"},"line_number":137,"absolute_offset":5306,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'signature.max' => 'Digital signature file size must not exceed 5MB.',\n"},"line_number":138,"absolute_offset":5394,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type.required' => 'At least one service must be selected.',\n"},"line_number":139,"absolute_offset":5477,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type.min' => 'At least one service must be selected.',\n"},"line_number":140,"absolute_offset":5558,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type.*.required' => 'Service type is required.',\n"},"line_number":141,"absolute_offset":5634,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type.*.in' => 'Invalid service type selected.',\n"},"line_number":142,"absolute_offset":5704,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'internetPurposes.required' => 'Internet purposes are required when internet access is selected.',\n"},"line_number":143,"absolute_offset":5773,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'internetPurposes.min' => 'At least one internet purpose must be provided.',\n"},"line_number":144,"absolute_offset":5884,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'internetPurposes.max' => 'Maximum 4 internet purposes are allowed.',\n"},"line_number":145,"absolute_offset":5973,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'internetPurposes.*.max' => 'Each internet purpose must not exceed 255 characters.',\n"},"line_number":146,"absolute_offset":6055,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        ];\n"},"line_number":147,"absolute_offset":6152,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    }\n"},"line_number":148,"absolute_offset":6163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":149,"absolute_offset":6169,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    /**\n"},"line_number":150,"absolute_offset":6170,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     * Get custom attributes for validator errors.\n"},"line_number":151,"absolute_offset":6178,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"     */\n"},"line_number":152,"absolute_offset":6229,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    public function attributes(): array\n"},"line_number":153,"absolute_offset":6237,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    {\n"},"line_number":154,"absolute_offset":6277,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        return [\n"},"line_number":155,"absolute_offset":6283,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'pf_number' => 'PF Number',\n"},"line_number":156,"absolute_offset":6300,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'staff_name' => 'Staff Name',\n"},"line_number":157,"absolute_offset":6340,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'phone_number' => 'Phone Number',\n"},"line_number":158,"absolute_offset":6382,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'department_id' => 'Department',\n"},"line_number":159,"absolute_offset":6428,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'signature' => 'Digital Signature',\n"},"line_number":160,"absolute_offset":6473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'request_type' => 'Services',\n"},"line_number":161,"absolute_offset":6521,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"            'internetPurposes' => 'Internet Purposes',\n"},"line_number":162,"absolute_offset":6563,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"        ];\n"},"line_number":163,"absolute_offset":6618,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"    }\n"},"line_number":164,"absolute_offset":6629,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"lines":{"text":"\n"},"line_number":165,"absolute_offset":6635,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Requests\\UserAccessRequest.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":488500,"human":"0.000489s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":26716,"matched_lines":4,"matches":4}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"<?php\n"},"line_number":1,"absolute_offset":0,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"\n"},"line_number":2,"absolute_offset":6,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"namespace App\\Http\\Requests\\BothServiceForm;\n"},"line_number":3,"absolute_offset":7,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"\n"},"line_number":4,"absolute_offset":52,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"use Illuminate\\Foundation\\Http\\FormRequest;\n"},"line_number":5,"absolute_offset":53,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"\n"},"line_number":6,"absolute_offset":97,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"class CreateBothServiceFormRequest extends FormRequest\n"},"line_number":7,"absolute_offset":98,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"{\n"},"line_number":8,"absolute_offset":153,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    /**\n"},"line_number":9,"absolute_offset":155,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     * Determine if the user is authorized to make this request.\n"},"line_number":10,"absolute_offset":163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     */\n"},"line_number":11,"absolute_offset":228,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    public function authorize(): bool\n"},"line_number":12,"absolute_offset":236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    {\n"},"line_number":13,"absolute_offset":274,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"        return true; // Authorization is handled in the controller\n"},"line_number":14,"absolute_offset":280,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    }\n"},"line_number":15,"absolute_offset":347,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"\n"},"line_number":16,"absolute_offset":353,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    /**\n"},"line_number":17,"absolute_offset":354,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     * Get the validation rules that apply to the request.\n"},"line_number":18,"absolute_offset":362,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     */\n"},"line_number":19,"absolute_offset":421,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    public function rules(): array\n"},"line_number":20,"absolute_offset":429,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    {\n"},"line_number":21,"absolute_offset":464,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"        return [\n"},"line_number":22,"absolute_offset":470,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'services_requested' => 'required|array|min:1',\n"},"line_number":23,"absolute_offset":487,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'services_requested.*' => 'required|string|in:wellsoft,jeeva,internet_access',\n"},"line_number":24,"absolute_offset":547,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'access_type' => 'required|in:permanent,temporary',\n"},"line_number":25,"absolute_offset":638,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'temporary_until' => 'nullable|date|required_if:access_type,temporary|after:today',\n"},"line_number":26,"absolute_offset":702,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'modules' => 'nullable|array',\n"},"line_number":27,"absolute_offset":798,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'modules.*' => 'string',\n"},"line_number":28,"absolute_offset":841,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'comments' => 'nullable|string|max:1000',\n"},"line_number":29,"absolute_offset":878,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'department_id' => 'required|exists:departments,id',\n"},"line_number":30,"absolute_offset":932,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'signature' => 'required|file|mimes:png,jpg,jpeg|max:2048',\n"},"line_number":31,"absolute_offset":997,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"        ];\n"},"line_number":32,"absolute_offset":1069,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    }\n"},"line_number":33,"absolute_offset":1080,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"\n"},"line_number":34,"absolute_offset":1086,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    /**\n"},"line_number":35,"absolute_offset":1087,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     * Get custom messages for validator errors.\n"},"line_number":36,"absolute_offset":1095,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"     */\n"},"line_number":37,"absolute_offset":1144,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    public function messages(): array\n"},"line_number":38,"absolute_offset":1152,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    {\n"},"line_number":39,"absolute_offset":1190,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"        return [\n"},"line_number":40,"absolute_offset":1196,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'services_requested.required' => 'At least one service must be selected.',\n"},"line_number":41,"absolute_offset":1213,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'services_requested.min' => 'At least one service must be selected.',\n"},"line_number":42,"absolute_offset":1300,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'services_requested.*.in' => 'Invalid service selected.',\n"},"line_number":43,"absolute_offset":1382,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'temporary_until.required_if' => 'End date is required for temporary access.',\n"},"line_number":44,"absolute_offset":1452,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'temporary_until.after' => 'End date must be in the future.',\n"},"line_number":45,"absolute_offset":1543,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'department_id.required' => 'Department is required.',\n"},"line_number":46,"absolute_offset":1617,"submatches":[{"match":{"text":"department_id.required' ="},"start":13,"end":38}]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'department_id.exists' => 'Selected department is invalid.',\n"},"line_number":47,"absolute_offset":1684,"submatches":[{"match":{"text":"department_id.exists' ="},"start":13,"end":36}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'signature.required' => 'Signature is required.',\n"},"line_number":48,"absolute_offset":1757,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'signature.mimes' => 'Signature must be a PNG, JPG, or JPEG image.',\n"},"line_number":49,"absolute_offset":1819,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"            'signature.max' => 'Signature file size must not exceed 2MB.',\n"},"line_number":50,"absolute_offset":1900,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"        ];\n"},"line_number":51,"absolute_offset":1975,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"    }\n"},"line_number":52,"absolute_offset":1986,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"lines":{"text":"}"},"line_number":53,"absolute_offset":1992,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Requests\\BothServiceForm\\CreateBothServiceFormRequest.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":91900,"human":"0.000092s"},"searches":1,"searches_with_match":1,"bytes_searched":1993,"bytes_printed":13012,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"}}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            echo \"Reverting JSON conversion and expanding consolidated records...\\n\";\n"},"line_number":121,"absolute_offset":5133,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \n"},"line_number":122,"absolute_offset":5219,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            // Get all records with JSON request_types\n"},"line_number":123,"absolute_offset":5232,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            $jsonRecords = DB::select(\"\n"},"line_number":124,"absolute_offset":5287,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                SELECT id, user_id, pf_number, staff_name, phone_number, department_id, \n"},"line_number":125,"absolute_offset":5327,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                       signature_path, purpose, request_type, status, created_at, updated_at\n"},"line_number":126,"absolute_offset":5416,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                FROM user_access \n"},"line_number":127,"absolute_offset":5509,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                WHERE JSON_VALID(request_type) = 1\n"},"line_number":128,"absolute_offset":5543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \");\n"},"line_number":129,"absolute_offset":5594,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \n"},"line_number":130,"absolute_offset":5610,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            foreach ($jsonRecords as $record) {\n"},"line_number":131,"absolute_offset":5623,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                $requestTypes = json_decode($record->request_type, true);\n"},"line_number":132,"absolute_offset":5671,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                $purposes = json_decode($record->purpose, true);\n"},"line_number":133,"absolute_offset":5745,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                \n"},"line_number":134,"absolute_offset":5810,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                if (is_array($requestTypes) && count($requestTypes) > 1) {\n"},"line_number":135,"absolute_offset":5827,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    // Keep the first request type in the original record\n"},"line_number":136,"absolute_offset":5902,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    DB::table('user_access')\n"},"line_number":137,"absolute_offset":5976,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                        ->where('id', $record->id)\n"},"line_number":138,"absolute_offset":6021,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                        ->update([\n"},"line_number":139,"absolute_offset":6072,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'request_type' => $requestTypes[0],\n"},"line_number":140,"absolute_offset":6107,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'purpose' => is_array($purposes) && !empty($purposes) ? $purposes[0] : $record->purpose\n"},"line_number":141,"absolute_offset":6171,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                        ]);\n"},"line_number":142,"absolute_offset":6287,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    \n"},"line_number":143,"absolute_offset":6315,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    // Create new records for additional request types\n"},"line_number":144,"absolute_offset":6336,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    for ($i = 1; $i < count($requestTypes); $i++) {\n"},"line_number":145,"absolute_offset":6407,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                        DB::table('user_access')->insert([\n"},"line_number":146,"absolute_offset":6475,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'user_id' => $record->user_id,\n"},"line_number":147,"absolute_offset":6534,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'pf_number' => $record->pf_number,\n"},"line_number":148,"absolute_offset":6593,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'staff_name' => $record->staff_name,\n"},"line_number":149,"absolute_offset":6656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'phone_number' => $record->phone_number,\n"},"line_number":150,"absolute_offset":6721,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'department_id' => $record->department_id,\n"},"line_number":151,"absolute_offset":6790,"submatches":[{"match":{"text":"department_id' ="},"start":29,"end":45}]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'signature_path' => $record->signature_path,\n"},"line_number":152,"absolute_offset":6861,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'purpose' => is_array($purposes) && isset($purposes[$i]) ? $purposes[$i] : null,\n"},"line_number":153,"absolute_offset":6934,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'request_type' => $requestTypes[$i],\n"},"line_number":154,"absolute_offset":7043,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'status' => $record->status,\n"},"line_number":155,"absolute_offset":7108,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'created_at' => $record->created_at,\n"},"line_number":156,"absolute_offset":7165,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                            'updated_at' => $record->updated_at\n"},"line_number":157,"absolute_offset":7230,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                        ]);\n"},"line_number":158,"absolute_offset":7294,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                    }\n"},"line_number":159,"absolute_offset":7322,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"                }\n"},"line_number":160,"absolute_offset":7344,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            }\n"},"line_number":161,"absolute_offset":7362,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \n"},"line_number":162,"absolute_offset":7376,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            // Convert columns back to original types\n"},"line_number":163,"absolute_offset":7389,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            DB::statement(\"ALTER TABLE user_access MODIFY COLUMN request_type ENUM('jeeva_access', 'wellsoft', 'internet_access_request')\");\n"},"line_number":164,"absolute_offset":7443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            DB::statement('ALTER TABLE user_access MODIFY COLUMN purpose TEXT NULL');\n"},"line_number":165,"absolute_offset":7584,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \n"},"line_number":166,"absolute_offset":7670,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            echo \"Rollback completed successfully!\\n\";\n"},"line_number":167,"absolute_offset":7683,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            \n"},"line_number":168,"absolute_offset":7738,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":169,"absolute_offset":7751,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            echo \"Rollback failed: \" . $e->getMessage() . \"\\n\";\n"},"line_number":170,"absolute_offset":7785,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"            throw $e;\n"},"line_number":171,"absolute_offset":7849,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"        }\n"},"line_number":172,"absolute_offset":7871,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"    }\n"},"line_number":173,"absolute_offset":7881,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"lines":{"text":"};"},"line_number":174,"absolute_offset":7887,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\database\\migrations\\2025_08_21_110000_convert_user_access_to_json_and_consolidate.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":105100,"human":"0.000105s"},"searches":1,"searches_with_match":1,"bytes_searched":7889,"bytes_printed":14901,"matched_lines":1,"matches":1}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"        }\n"},"line_number":118,"absolute_offset":4690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"    }\n"},"line_number":119,"absolute_offset":4700,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"\n"},"line_number":120,"absolute_offset":4706,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"    /**\n"},"line_number":121,"absolute_offset":4707,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"     * Store a newly created department.\n"},"line_number":122,"absolute_offset":4715,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"     */\n"},"line_number":123,"absolute_offset":4756,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"    public function store(DepartmentRequest $request): JsonResponse\n"},"line_number":124,"absolute_offset":4764,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"    {\n"},"line_number":125,"absolute_offset":4832,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"\n"},"line_number":126,"absolute_offset":4838,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"        DB::beginTransaction();\n"},"line_number":127,"absolute_offset":4839,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"        \n"},"line_number":128,"absolute_offset":4871,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"        try {\n"},"line_number":129,"absolute_offset":4880,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            $validatedData = $request->validated();\n"},"line_number":130,"absolute_offset":4894,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            \n"},"line_number":131,"absolute_offset":4946,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            $departmentData = [\n"},"line_number":132,"absolute_offset":4959,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'name' => $validatedData['name'],\n"},"line_number":133,"absolute_offset":4991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'code' => $validatedData['code'], // Already uppercase from DepartmentRequest\n"},"line_number":134,"absolute_offset":5041,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'description' => $validatedData['description'] ?? null,\n"},"line_number":135,"absolute_offset":5135,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'is_active' => $validatedData['is_active'],\n"},"line_number":136,"absolute_offset":5207,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'hod_user_id' => $validatedData['hod_user_id'] ?? null,\n"},"line_number":137,"absolute_offset":5267,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'has_divisional_director' => $validatedData['has_divisional_director'],\n"},"line_number":138,"absolute_offset":5339,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                'divisional_director_id' => $validatedData['divisional_director_id'] ?? null,\n"},"line_number":139,"absolute_offset":5427,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            ];\n"},"line_number":140,"absolute_offset":5521,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"\n"},"line_number":141,"absolute_offset":5536,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            $department = Department::create($departmentData);\n"},"line_number":142,"absolute_offset":5537,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"\n"},"line_number":143,"absolute_offset":5600,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            // Assign department_id to HOD if specified and ensure they have HOD role\n"},"line_number":144,"absolute_offset":5601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            if ($department->hod_user_id) {\n"},"line_number":145,"absolute_offset":5687,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                $hod = \\App\\Models\\User::find($department->hod_user_id);\n"},"line_number":146,"absolute_offset":5731,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                if ($hod) {\n"},"line_number":147,"absolute_offset":5804,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    $hod->update(['department_id' => $department->id]);\n"},"line_number":148,"absolute_offset":5832,"submatches":[{"match":{"text":"department_id' ="},"start":35,"end":51}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    \n"},"line_number":149,"absolute_offset":5904,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    // Ensure HOD has the head_of_department role\n"},"line_number":150,"absolute_offset":5925,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    $hodRole = \\App\\Models\\Role::where('name', 'head_of_department')->first();\n"},"line_number":151,"absolute_offset":5991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    if ($hodRole && !$hod->hasRole('head_of_department')) {\n"},"line_number":152,"absolute_offset":6086,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        $hod->roles()->attach($hodRole->id, [\n"},"line_number":153,"absolute_offset":6162,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'assigned_at' => now(),\n"},"line_number":154,"absolute_offset":6224,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'assigned_by' => $request->user()->id,\n"},"line_number":155,"absolute_offset":6276,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'created_at' => now(),\n"},"line_number":156,"absolute_offset":6343,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'updated_at' => now(),\n"},"line_number":157,"absolute_offset":6394,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        ]);\n"},"line_number":158,"absolute_offset":6445,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        \n"},"line_number":159,"absolute_offset":6473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        // Log role assignment\n"},"line_number":160,"absolute_offset":6498,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        \\App\\Models\\RoleChangeLog::create([\n"},"line_number":161,"absolute_offset":6545,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'user_id' => $hod->id,\n"},"line_number":162,"absolute_offset":6605,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'role_id' => $hodRole->id,\n"},"line_number":163,"absolute_offset":6656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'action' => 'assigned',\n"},"line_number":164,"absolute_offset":6711,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'changed_by' => $request->user()->id,\n"},"line_number":165,"absolute_offset":6763,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'changed_at' => now(),\n"},"line_number":166,"absolute_offset":6829,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'metadata' => [\n"},"line_number":167,"absolute_offset":6880,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'user_email' => $hod->email,\n"},"line_number":168,"absolute_offset":6924,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'changed_by_email' => $request->user()->email,\n"},"line_number":169,"absolute_offset":6985,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'context' => 'hod_department_assignment'\n"},"line_number":170,"absolute_offset":7064,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            ]\n"},"line_number":171,"absolute_offset":7137,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        ]);\n"},"line_number":172,"absolute_offset":7167,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    }\n"},"line_number":173,"absolute_offset":7195,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    \n"},"line_number":174,"absolute_offset":7217,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    Log::info('Assigned department to HOD during creation', [\n"},"line_number":175,"absolute_offset":7238,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'user_id' => $department->hod_user_id,\n"},"line_number":176,"absolute_offset":7316,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'department_id' => $department->id,\n"},"line_number":177,"absolute_offset":7379,"submatches":[{"match":{"text":"department_id' ="},"start":25,"end":41}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'role_assigned' => $hodRole ? true : false\n"},"line_number":178,"absolute_offset":7439,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    ]);\n"},"line_number":179,"absolute_offset":7506,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                }\n"},"line_number":180,"absolute_offset":7530,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            }\n"},"line_number":181,"absolute_offset":7548,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"\n"},"line_number":182,"absolute_offset":7562,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            // Assign department_id to Divisional Director if specified and ensure they have the role\n"},"line_number":183,"absolute_offset":7563,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"            if ($department->divisional_director_id) {\n"},"line_number":184,"absolute_offset":7665,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                $director = \\App\\Models\\User::find($department->divisional_director_id);\n"},"line_number":185,"absolute_offset":7720,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                if ($director) {\n"},"line_number":186,"absolute_offset":7809,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    $director->update(['department_id' => $department->id]);\n"},"line_number":187,"absolute_offset":7842,"submatches":[{"match":{"text":"department_id' ="},"start":40,"end":56}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    \n"},"line_number":188,"absolute_offset":7919,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    // Ensure Director has the divisional_director role\n"},"line_number":189,"absolute_offset":7940,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    $directorRole = \\App\\Models\\Role::where('name', 'divisional_director')->first();\n"},"line_number":190,"absolute_offset":8012,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    if ($directorRole && !$director->hasRole('divisional_director')) {\n"},"line_number":191,"absolute_offset":8113,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        $director->roles()->attach($directorRole->id, [\n"},"line_number":192,"absolute_offset":8200,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'assigned_at' => now(),\n"},"line_number":193,"absolute_offset":8272,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'assigned_by' => $request->user()->id,\n"},"line_number":194,"absolute_offset":8324,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'created_at' => now(),\n"},"line_number":195,"absolute_offset":8391,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'updated_at' => now(),\n"},"line_number":196,"absolute_offset":8442,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        ]);\n"},"line_number":197,"absolute_offset":8493,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        \n"},"line_number":198,"absolute_offset":8521,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        // Log role assignment\n"},"line_number":199,"absolute_offset":8546,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        \\App\\Models\\RoleChangeLog::create([\n"},"line_number":200,"absolute_offset":8593,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'user_id' => $director->id,\n"},"line_number":201,"absolute_offset":8653,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'role_id' => $directorRole->id,\n"},"line_number":202,"absolute_offset":8709,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'action' => 'assigned',\n"},"line_number":203,"absolute_offset":8769,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'changed_by' => $request->user()->id,\n"},"line_number":204,"absolute_offset":8821,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'changed_at' => now(),\n"},"line_number":205,"absolute_offset":8887,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            'metadata' => [\n"},"line_number":206,"absolute_offset":8938,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'user_email' => $director->email,\n"},"line_number":207,"absolute_offset":8982,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'changed_by_email' => $request->user()->email,\n"},"line_number":208,"absolute_offset":9048,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                                'context' => 'director_department_assignment'\n"},"line_number":209,"absolute_offset":9127,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                            ]\n"},"line_number":210,"absolute_offset":9205,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        ]);\n"},"line_number":211,"absolute_offset":9235,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    }\n"},"line_number":212,"absolute_offset":9263,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    \n"},"line_number":213,"absolute_offset":9285,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                    Log::info('Assigned department to Divisional Director during creation', [\n"},"line_number":214,"absolute_offset":9306,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'user_id' => $department->divisional_director_id,\n"},"line_number":215,"absolute_offset":9400,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'department_id' => $department->id,\n"},"line_number":216,"absolute_offset":9474,"submatches":[{"match":{"text":"department_id' ="},"start":25,"end":41}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"lines":{"text":"                        'role_assigned' => $directorRole ? true : false\n"},"line_number":217,"absolute_offset":9534,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminDepartmentController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":284300,"human":"0.000284s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":24870,"matched_lines":4,"matches":4}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            if ($request->has('status') && $request->status !== 'all') {\n"},"line_number":72,"absolute_offset":2481,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                $isActive = $request->status === 'active';\n"},"line_number":73,"absolute_offset":2554,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                $query->where('is_active', $isActive);\n"},"line_number":74,"absolute_offset":2613,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            }\n"},"line_number":75,"absolute_offset":2668,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":76,"absolute_offset":2682,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            // Exclude super admin users from the list\n"},"line_number":77,"absolute_offset":2683,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $query->whereDoesntHave('roles', function ($q) {\n"},"line_number":78,"absolute_offset":2738,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                $q->where('name', 'super_admin');\n"},"line_number":79,"absolute_offset":2799,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            });\n"},"line_number":80,"absolute_offset":2849,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":81,"absolute_offset":2865,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            // Sorting\n"},"line_number":82,"absolute_offset":2866,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $sortBy = $request->get('sort_by', 'name');\n"},"line_number":83,"absolute_offset":2889,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $sortOrder = $request->get('sort_order', 'asc');\n"},"line_number":84,"absolute_offset":2945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $query->orderBy($sortBy, $sortOrder);\n"},"line_number":85,"absolute_offset":3006,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":86,"absolute_offset":3056,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            // Pagination\n"},"line_number":87,"absolute_offset":3057,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $perPage = $request->get('per_page', 20);\n"},"line_number":88,"absolute_offset":3083,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $users = $query->paginate($perPage);\n"},"line_number":89,"absolute_offset":3137,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":90,"absolute_offset":3186,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            // Transform the data\n"},"line_number":91,"absolute_offset":3187,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $transformedUsers = $users->getCollection()->map(function ($user) {\n"},"line_number":92,"absolute_offset":3221,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                $onboarding = $user->onboarding;\n"},"line_number":93,"absolute_offset":3301,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                \n"},"line_number":94,"absolute_offset":3350,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                return [\n"},"line_number":95,"absolute_offset":3367,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'id' => $user->id,\n"},"line_number":96,"absolute_offset":3392,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'name' => $user->name,\n"},"line_number":97,"absolute_offset":3431,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'email' => $user->email,\n"},"line_number":98,"absolute_offset":3474,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'pf_number' => $user->pf_number,\n"},"line_number":99,"absolute_offset":3519,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'staff_name' => $user->staff_name,\n"},"line_number":100,"absolute_offset":3572,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'phone' => $user->phone,\n"},"line_number":101,"absolute_offset":3627,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'department_id' => $user->department_id,\n"},"line_number":102,"absolute_offset":3672,"submatches":[{"match":{"text":"department_id' ="},"start":21,"end":37}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'department' => $user->department ? [\n"},"line_number":103,"absolute_offset":3733,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'id' => $user->department->id,\n"},"line_number":104,"absolute_offset":3791,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'name' => $user->department->name,\n"},"line_number":105,"absolute_offset":3846,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'code' => $user->department->code,\n"},"line_number":106,"absolute_offset":3905,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'display_name' => $user->department->getFullNameAttribute()\n"},"line_number":107,"absolute_offset":3964,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    ] : null,\n"},"line_number":108,"absolute_offset":4048,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'is_active' => $user->is_active ?? true,\n"},"line_number":109,"absolute_offset":4078,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'roles' => $user->roles->map(function ($role) {\n"},"line_number":110,"absolute_offset":4139,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        return [\n"},"line_number":111,"absolute_offset":4207,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'id' => $role->id,\n"},"line_number":112,"absolute_offset":4240,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'name' => $role->name,\n"},"line_number":113,"absolute_offset":4287,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'display_name' => ucwords(str_replace('_', ' ', $role->name)),\n"},"line_number":114,"absolute_offset":4338,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'assigned_at' => $role->pivot->assigned_at,\n"},"line_number":115,"absolute_offset":4429,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        ];\n"},"line_number":116,"absolute_offset":4501,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    }),\n"},"line_number":117,"absolute_offset":4528,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'role_names' => $user->roles->pluck('name')->toArray(),\n"},"line_number":118,"absolute_offset":4552,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'display_roles' => $user->getDisplayRoleNames(),\n"},"line_number":119,"absolute_offset":4628,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'departments_as_hod' => $user->departmentsAsHOD->map(function ($dept) {\n"},"line_number":120,"absolute_offset":4697,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        return [\n"},"line_number":121,"absolute_offset":4789,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'id' => $dept->id,\n"},"line_number":122,"absolute_offset":4822,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'name' => $dept->name,\n"},"line_number":123,"absolute_offset":4869,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                            'code' => $dept->code,\n"},"line_number":124,"absolute_offset":4920,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        ];\n"},"line_number":125,"absolute_offset":4971,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    }),\n"},"line_number":126,"absolute_offset":4998,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'is_hod' => $user->departmentsAsHOD->isNotEmpty(),\n"},"line_number":127,"absolute_offset":5022,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'created_at' => $user->created_at,\n"},"line_number":128,"absolute_offset":5093,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'updated_at' => $user->updated_at,\n"},"line_number":129,"absolute_offset":5148,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'onboarding_status' => [\n"},"line_number":130,"absolute_offset":5203,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'needs_onboarding' => $user->needsOnboarding(),\n"},"line_number":131,"absolute_offset":5248,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'completed' => $onboarding ? $onboarding->completed : false,\n"},"line_number":132,"absolute_offset":5320,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'to' => $users->lastItem()\n"},"line_number":156,"absolute_offset":6358,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    ]\n"},"line_number":157,"absolute_offset":6409,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                ]\n"},"line_number":158,"absolute_offset":6431,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            ]);\n"},"line_number":159,"absolute_offset":6449,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":160,"absolute_offset":6465,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":161,"absolute_offset":6466,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            Log::error('Error retrieving users for admin', [\n"},"line_number":162,"absolute_offset":6500,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'admin_id' => $request->user()->id,\n"},"line_number":163,"absolute_offset":6561,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'error' => $e->getMessage(),\n"},"line_number":164,"absolute_offset":6613,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'trace' => $e->getTraceAsString()\n"},"line_number":165,"absolute_offset":6658,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            ]);\n"},"line_number":166,"absolute_offset":6708,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":167,"absolute_offset":6724,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":168,"absolute_offset":6725,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":169,"absolute_offset":6763,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'message' => 'Failed to retrieve users'\n"},"line_number":170,"absolute_offset":6799,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            ], 500);\n"},"line_number":171,"absolute_offset":6855,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        }\n"},"line_number":172,"absolute_offset":6876,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"    }\n"},"line_number":173,"absolute_offset":6886,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":174,"absolute_offset":6892,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"    /**\n"},"line_number":175,"absolute_offset":6893,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"     * Store a newly created user\n"},"line_number":176,"absolute_offset":6901,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"     */\n"},"line_number":177,"absolute_offset":6935,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"    public function store(Request $request): JsonResponse\n"},"line_number":178,"absolute_offset":6943,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"    {\n"},"line_number":179,"absolute_offset":7001,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        $validator = Validator::make($request->all(), [\n"},"line_number":180,"absolute_offset":7007,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'name' => 'required|string|max:255',\n"},"line_number":181,"absolute_offset":7063,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'email' => 'required|string|email|max:255|unique:users',\n"},"line_number":182,"absolute_offset":7112,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'phone' => 'nullable|string|max:20',\n"},"line_number":183,"absolute_offset":7181,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'pf_number' => 'nullable|string|max:50|unique:users',\n"},"line_number":184,"absolute_offset":7230,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'staff_name' => 'nullable|string|max:255',\n"},"line_number":185,"absolute_offset":7296,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'department_id' => 'nullable|exists:departments,id',\n"},"line_number":186,"absolute_offset":7351,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password' => 'required|string|min:8',\n"},"line_number":187,"absolute_offset":7416,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password_confirmation' => 'required|string|same:password',\n"},"line_number":188,"absolute_offset":7467,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids' => 'required|array|min:1',\n"},"line_number":189,"absolute_offset":7539,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids.*' => 'exists:roles,id',\n"},"line_number":190,"absolute_offset":7589,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'is_active' => 'boolean'\n"},"line_number":191,"absolute_offset":7636,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        ], [\n"},"line_number":192,"absolute_offset":7673,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'name.required' => 'Full name is required.',\n"},"line_number":193,"absolute_offset":7686,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'email.required' => 'Email address is required.',\n"},"line_number":194,"absolute_offset":7743,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'email.email' => 'Please provide a valid email address.',\n"},"line_number":195,"absolute_offset":7805,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'email.unique' => 'This email address is already registered.',\n"},"line_number":196,"absolute_offset":7875,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'pf_number.unique' => 'This PF number is already registered.',\n"},"line_number":197,"absolute_offset":7950,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password.required' => 'Password is required.',\n"},"line_number":198,"absolute_offset":8025,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password.min' => 'Password must be at least 8 characters long.',\n"},"line_number":199,"absolute_offset":8085,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password_confirmation.required' => 'Password confirmation is required.',\n"},"line_number":200,"absolute_offset":8163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'password_confirmation.same' => 'Password confirmation does not match.',\n"},"line_number":201,"absolute_offset":8249,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids.required' => 'At least one role must be assigned.',\n"},"line_number":202,"absolute_offset":8334,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids.array' => 'Roles must be provided as an array.',\n"},"line_number":203,"absolute_offset":8408,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids.min' => 'At least one role must be assigned.',\n"},"line_number":204,"absolute_offset":8479,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'role_ids.*.exists' => 'One or more selected roles do not exist.',\n"},"line_number":205,"absolute_offset":8548,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            'department_id.exists' => 'Selected department does not exist.'\n"},"line_number":206,"absolute_offset":8627,"submatches":[{"match":{"text":"department_id.exists' ="},"start":13,"end":36}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        ]);\n"},"line_number":207,"absolute_offset":8703,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":208,"absolute_offset":8715,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        if ($validator->fails()) {\n"},"line_number":209,"absolute_offset":8716,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":210,"absolute_offset":8751,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":211,"absolute_offset":8789,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'message' => 'Validation failed',\n"},"line_number":212,"absolute_offset":8825,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                'errors' => $validator->errors()\n"},"line_number":213,"absolute_offset":8875,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            ], 422);\n"},"line_number":214,"absolute_offset":8924,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        }\n"},"line_number":215,"absolute_offset":8945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":216,"absolute_offset":8955,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        // Additional validation for privilege escalation\n"},"line_number":217,"absolute_offset":8956,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        $currentUser = $request->user();\n"},"line_number":218,"absolute_offset":9014,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        $roleIds = $request->input('role_ids', []);\n"},"line_number":219,"absolute_offset":9055,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":220,"absolute_offset":9107,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        if (!$currentUser->isAdmin()) {\n"},"line_number":221,"absolute_offset":9108,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $adminRoles = Role::whereIn('name', ['admin'])->pluck('id')->toArray();\n"},"line_number":222,"absolute_offset":9148,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            $hasAdminRole = !empty(array_intersect($roleIds, $adminRoles));\n"},"line_number":223,"absolute_offset":9232,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            \n"},"line_number":224,"absolute_offset":9308,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            if ($hasAdminRole) {\n"},"line_number":225,"absolute_offset":9321,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":226,"absolute_offset":9354,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":227,"absolute_offset":9396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'message' => 'Validation failed',\n"},"line_number":228,"absolute_offset":9436,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    'errors' => [\n"},"line_number":229,"absolute_offset":9490,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                        'role_ids' => ['You cannot assign admin roles.']\n"},"line_number":230,"absolute_offset":9524,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                    ]\n"},"line_number":231,"absolute_offset":9597,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"                ], 422);\n"},"line_number":232,"absolute_offset":9619,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"            }\n"},"line_number":233,"absolute_offset":9644,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        }\n"},"line_number":234,"absolute_offset":9658,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"\n"},"line_number":235,"absolute_offset":9668,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"lines":{"text":"        DB::beginTransaction();\n"},"line_number":236,"absolute_offset":9669,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\AdminUserController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":391700,"human":"0.000392s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":33502,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    public function index(Request $request): JsonResponse\n"},"line_number":20,"absolute_offset":457,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    {\n"},"line_number":21,"absolute_offset":515,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"        try {\n"},"line_number":22,"absolute_offset":521,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            Log::info('HOD Combined Access: Fetching requests', [\n"},"line_number":23,"absolute_offset":535,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'user_id' => auth()->id(),\n"},"line_number":24,"absolute_offset":601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'user_name' => auth()->user()->name ?? 'Unknown',\n"},"line_number":25,"absolute_offset":644,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'user_email' => auth()->user()->email ?? 'Unknown',\n"},"line_number":26,"absolute_offset":710,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'filters' => $request->all()\n"},"line_number":27,"absolute_offset":778,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":28,"absolute_offset":823,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":29,"absolute_offset":839,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $query = UserAccess::with(['user', 'department'])\n"},"line_number":30,"absolute_offset":840,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ->whereNotNull('request_type')\n"},"line_number":31,"absolute_offset":902,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ->where(function ($q) {\n"},"line_number":32,"absolute_offset":949,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    // Get requests that need HOD approval or are pending HOD\n"},"line_number":33,"absolute_offset":989,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    $q->where('status', 'pending')\n"},"line_number":34,"absolute_offset":1067,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('status', 'pending_hod')\n"},"line_number":35,"absolute_offset":1118,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('status', 'hod_approved')\n"},"line_number":36,"absolute_offset":1177,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('status', 'hod_rejected');\n"},"line_number":37,"absolute_offset":1237,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                });\n"},"line_number":38,"absolute_offset":1298,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":39,"absolute_offset":1318,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            // DEPARTMENT FILTERING: HOD only sees requests from their department(s)\n"},"line_number":40,"absolute_offset":1319,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $currentUser = auth()->user();\n"},"line_number":41,"absolute_offset":1404,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $hodDepartmentIds = $currentUser->departmentsAsHOD()->pluck('id')->toArray();\n"},"line_number":42,"absolute_offset":1447,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            \n"},"line_number":43,"absolute_offset":1537,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            if (!empty($hodDepartmentIds)) {\n"},"line_number":44,"absolute_offset":1550,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                $query->whereIn('department_id', $hodDepartmentIds);\n"},"line_number":45,"absolute_offset":1595,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                Log::info('HOD Department Filter Applied', [\n"},"line_number":46,"absolute_offset":1664,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":47,"absolute_offset":1725,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_name' => $currentUser->name,\n"},"line_number":48,"absolute_offset":1776,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_email' => $currentUser->email,\n"},"line_number":49,"absolute_offset":1831,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'hod_department_ids' => $hodDepartmentIds,\n"},"line_number":50,"absolute_offset":1888,"submatches":[{"match":{"text":"department_ids' ="},"start":25,"end":42}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'requests_before_dept_filter' => UserAccess::with(['user', 'department'])\n"},"line_number":51,"absolute_offset":1951,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->whereNotNull('request_type')\n"},"line_number":52,"absolute_offset":2045,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->where(function ($q) {\n"},"line_number":53,"absolute_offset":2100,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                            $q->where('status', 'pending')\n"},"line_number":54,"absolute_offset":2148,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                                ->orWhere('status', 'pending_hod')\n"},"line_number":55,"absolute_offset":2207,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                                ->orWhere('status', 'hod_approved')\n"},"line_number":56,"absolute_offset":2274,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                                ->orWhere('status', 'hod_rejected');\n"},"line_number":57,"absolute_offset":2342,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        })->count(),\n"},"line_number":58,"absolute_offset":2411,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'requests_after_dept_filter' => (clone $query)->count()\n"},"line_number":59,"absolute_offset":2448,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":60,"absolute_offset":2524,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            } else {\n"},"line_number":61,"absolute_offset":2544,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                // If user is not HOD of any department, show no requests\n"},"line_number":62,"absolute_offset":2565,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                Log::warning('HOD Access Attempt: User is not HOD of any department', [\n"},"line_number":63,"absolute_offset":2639,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":64,"absolute_offset":2727,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_name' => $currentUser->name,\n"},"line_number":65,"absolute_offset":2778,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_email' => $currentUser->email,\n"},"line_number":66,"absolute_offset":2833,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_roles' => $currentUser->roles()->pluck('name')->toArray() ?? 'No roles loaded'\n"},"line_number":67,"absolute_offset":2890,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":68,"absolute_offset":2995,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                $query->whereRaw('1 = 0'); // This will return no results\n"},"line_number":69,"absolute_offset":3015,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            }\n"},"line_number":70,"absolute_offset":3089,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":71,"absolute_offset":3103,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            // Apply filters\n"},"line_number":72,"absolute_offset":3104,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            if ($request->filled('search')) {\n"},"line_number":73,"absolute_offset":3133,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                $searchTerm = $request->search;\n"},"line_number":74,"absolute_offset":3179,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                $query->where(function ($q) use ($searchTerm) {\n"},"line_number":75,"absolute_offset":3227,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    $q->where('staff_name', 'like', \"%{$searchTerm}%\")\n"},"line_number":76,"absolute_offset":3291,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('pf_number', 'like', \"%{$searchTerm}%\")\n"},"line_number":77,"absolute_offset":3362,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        ->orWhereHas('department', function ($dq) use ($searchTerm) {\n"},"line_number":78,"absolute_offset":3436,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                            $dq->where('name', 'like', \"%{$searchTerm}%\");\n"},"line_number":79,"absolute_offset":3522,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                        })\n"},"line_number":80,"absolute_offset":3597,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":119,"absolute_offset":4969,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":120,"absolute_offset":4970,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":121,"absolute_offset":5008,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'message' => 'Failed to retrieve combined access requests',\n"},"line_number":122,"absolute_offset":5044,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'error' => app()->environment('local') ? $e->getMessage() : 'Internal server error'\n"},"line_number":123,"absolute_offset":5120,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ], 500);\n"},"line_number":124,"absolute_offset":5220,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"        }\n"},"line_number":125,"absolute_offset":5241,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    }\n"},"line_number":126,"absolute_offset":5251,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":127,"absolute_offset":5257,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    /**\n"},"line_number":128,"absolute_offset":5258,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"     * Get a specific combined access request by ID\n"},"line_number":129,"absolute_offset":5266,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"     */\n"},"line_number":130,"absolute_offset":5318,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    public function show($id): JsonResponse\n"},"line_number":131,"absolute_offset":5326,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"    {\n"},"line_number":132,"absolute_offset":5370,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"        try {\n"},"line_number":133,"absolute_offset":5376,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            Log::info('HOD Combined Access: Fetching specific request', [\n"},"line_number":134,"absolute_offset":5390,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'request_id' => $id,\n"},"line_number":135,"absolute_offset":5464,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'user_id' => auth()->id()\n"},"line_number":136,"absolute_offset":5501,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":137,"absolute_offset":5543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":138,"absolute_offset":5559,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $request = UserAccess::with(['user', 'department'])\n"},"line_number":139,"absolute_offset":5560,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ->findOrFail($id);\n"},"line_number":140,"absolute_offset":5624,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":141,"absolute_offset":5659,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            // DEPARTMENT AUTHORIZATION: Ensure HOD can only access requests from their department(s)\n"},"line_number":142,"absolute_offset":5660,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $currentUser = auth()->user();\n"},"line_number":143,"absolute_offset":5762,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $hodDepartmentIds = $currentUser->departmentsAsHOD()->pluck('id')->toArray();\n"},"line_number":144,"absolute_offset":5805,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            \n"},"line_number":145,"absolute_offset":5895,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            if (!empty($hodDepartmentIds) && !in_array($request->department_id, $hodDepartmentIds)) {\n"},"line_number":146,"absolute_offset":5908,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                Log::warning('HOD Access Denied: Request not from HOD department', [\n"},"line_number":147,"absolute_offset":6010,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":148,"absolute_offset":6095,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'request_department_id' => $request->department_id,\n"},"line_number":149,"absolute_offset":6146,"submatches":[{"match":{"text":"department_id' ="},"start":29,"end":45}]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'hod_department_ids' => $hodDepartmentIds\n"},"line_number":150,"absolute_offset":6218,"submatches":[{"match":{"text":"department_ids' ="},"start":25,"end":42}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":151,"absolute_offset":6280,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                \n"},"line_number":152,"absolute_offset":6300,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":153,"absolute_offset":6317,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":154,"absolute_offset":6359,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'message' => 'Access denied. You can only view requests from your department.',\n"},"line_number":155,"absolute_offset":6399,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                    'error' => 'Unauthorized access'\n"},"line_number":156,"absolute_offset":6499,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                ], 403);\n"},"line_number":157,"absolute_offset":6552,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            }\n"},"line_number":158,"absolute_offset":6577,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":159,"absolute_offset":6591,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            $transformedData = $this->transformRequestData($request);\n"},"line_number":160,"absolute_offset":6592,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":161,"absolute_offset":6662,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            Log::info('HOD Combined Access: Request retrieved successfully', [\n"},"line_number":162,"absolute_offset":6663,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'request_id' => $id\n"},"line_number":163,"absolute_offset":6742,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":164,"absolute_offset":6778,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":165,"absolute_offset":6794,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":166,"absolute_offset":6795,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":167,"absolute_offset":6833,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'message' => 'Request retrieved successfully',\n"},"line_number":168,"absolute_offset":6868,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'data' => $transformedData\n"},"line_number":169,"absolute_offset":6931,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":170,"absolute_offset":6974,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":171,"absolute_offset":6990,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":172,"absolute_offset":6991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            Log::error('HOD Combined Access: Error fetching request', [\n"},"line_number":173,"absolute_offset":7025,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'request_id' => $id,\n"},"line_number":174,"absolute_offset":7097,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'error' => $e->getMessage()\n"},"line_number":175,"absolute_offset":7134,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":176,"absolute_offset":7178,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":177,"absolute_offset":7194,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":178,"absolute_offset":7195,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":179,"absolute_offset":7233,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"lines":{"text":"                'message' => 'Request not found',\n"},"line_number":180,"absolute_offset":7269,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\HodCombinedAccessController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":260100,"human":"0.000260s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":30088,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"     */\n"},"line_number":19,"absolute_offset":485,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    public function index(Request $request): JsonResponse\n"},"line_number":20,"absolute_offset":493,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    {\n"},"line_number":21,"absolute_offset":551,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"        try {\n"},"line_number":22,"absolute_offset":557,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            Log::info('Divisional Combined Access: Fetching requests', [\n"},"line_number":23,"absolute_offset":571,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'user_id' => auth()->id(),\n"},"line_number":24,"absolute_offset":644,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'user_name' => auth()->user()->name ?? 'Unknown',\n"},"line_number":25,"absolute_offset":687,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'user_email' => auth()->user()->email ?? 'Unknown',\n"},"line_number":26,"absolute_offset":753,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'filters' => $request->all()\n"},"line_number":27,"absolute_offset":821,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":28,"absolute_offset":866,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":29,"absolute_offset":882,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $query = UserAccess::with(['user', 'department'])\n"},"line_number":30,"absolute_offset":883,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ->whereNotNull('request_type')\n"},"line_number":31,"absolute_offset":945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ->where(function ($q) {\n"},"line_number":32,"absolute_offset":992,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    // Get HOD-approved requests that need divisional approval or are already processed by divisional\n"},"line_number":33,"absolute_offset":1032,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    $q->where('status', 'hod_approved')\n"},"line_number":34,"absolute_offset":1150,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('status', 'divisional_approved')\n"},"line_number":35,"absolute_offset":1206,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('status', 'divisional_rejected');\n"},"line_number":36,"absolute_offset":1273,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                });\n"},"line_number":37,"absolute_offset":1341,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":38,"absolute_offset":1361,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            // DEPARTMENT FILTERING: Divisional Director only sees requests from their department(s)\n"},"line_number":39,"absolute_offset":1362,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $currentUser = auth()->user();\n"},"line_number":40,"absolute_offset":1463,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $divisionalDepartmentIds = $currentUser->departmentsAsDivisionalDirector()->pluck('id')->toArray();\n"},"line_number":41,"absolute_offset":1506,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            \n"},"line_number":42,"absolute_offset":1618,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            if (!empty($divisionalDepartmentIds)) {\n"},"line_number":43,"absolute_offset":1631,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                $query->whereIn('department_id', $divisionalDepartmentIds);\n"},"line_number":44,"absolute_offset":1683,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                Log::info('Divisional Department Filter Applied', [\n"},"line_number":45,"absolute_offset":1759,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":46,"absolute_offset":1827,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_name' => $currentUser->name,\n"},"line_number":47,"absolute_offset":1878,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_email' => $currentUser->email,\n"},"line_number":48,"absolute_offset":1933,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'divisional_department_ids' => $divisionalDepartmentIds,\n"},"line_number":49,"absolute_offset":1990,"submatches":[{"match":{"text":"department_ids' ="},"start":32,"end":49}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'requests_before_dept_filter' => UserAccess::with(['user', 'department'])\n"},"line_number":50,"absolute_offset":2067,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->whereNotNull('request_type')\n"},"line_number":51,"absolute_offset":2161,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->where(function ($q) {\n"},"line_number":52,"absolute_offset":2216,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                            $q->where('status', 'hod_approved')\n"},"line_number":53,"absolute_offset":2264,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                                ->orWhere('status', 'divisional_approved')\n"},"line_number":54,"absolute_offset":2328,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                                ->orWhere('status', 'divisional_rejected');\n"},"line_number":55,"absolute_offset":2403,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        })->count(),\n"},"line_number":56,"absolute_offset":2479,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'requests_after_dept_filter' => (clone $query)->count()\n"},"line_number":57,"absolute_offset":2516,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":58,"absolute_offset":2592,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            } else {\n"},"line_number":59,"absolute_offset":2612,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                // If user is not Divisional Director of any department, show no requests\n"},"line_number":60,"absolute_offset":2633,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                Log::warning('Divisional Access Attempt: User is not Divisional Director of any department', [\n"},"line_number":61,"absolute_offset":2723,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":62,"absolute_offset":2834,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_name' => $currentUser->name,\n"},"line_number":63,"absolute_offset":2885,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_email' => $currentUser->email,\n"},"line_number":64,"absolute_offset":2940,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_roles' => $currentUser->roles()->pluck('name')->toArray() ?? 'No roles loaded'\n"},"line_number":65,"absolute_offset":2997,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":66,"absolute_offset":3102,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                $query->whereRaw('1 = 0'); // This will return no results\n"},"line_number":67,"absolute_offset":3122,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            }\n"},"line_number":68,"absolute_offset":3196,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":69,"absolute_offset":3210,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            // Apply filters\n"},"line_number":70,"absolute_offset":3211,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            if ($request->filled('search')) {\n"},"line_number":71,"absolute_offset":3240,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                $searchTerm = $request->search;\n"},"line_number":72,"absolute_offset":3286,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                $query->where(function ($q) use ($searchTerm) {\n"},"line_number":73,"absolute_offset":3334,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    $q->where('staff_name', 'like', \"%{$searchTerm}%\")\n"},"line_number":74,"absolute_offset":3398,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('pf_number', 'like', \"%{$searchTerm}%\")\n"},"line_number":75,"absolute_offset":3469,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->orWhereHas('department', function ($dq) use ($searchTerm) {\n"},"line_number":76,"absolute_offset":3543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                            $dq->where('name', 'like', \"%{$searchTerm}%\");\n"},"line_number":77,"absolute_offset":3629,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        })\n"},"line_number":78,"absolute_offset":3704,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                        ->orWhere('id', 'like', \"%{$searchTerm}%\");\n"},"line_number":79,"absolute_offset":3731,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":117,"absolute_offset":5128,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":118,"absolute_offset":5129,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":119,"absolute_offset":5167,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'message' => 'Failed to retrieve HOD-approved combined access requests',\n"},"line_number":120,"absolute_offset":5203,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'error' => app()->environment('local') ? $e->getMessage() : 'Internal server error'\n"},"line_number":121,"absolute_offset":5292,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            ], 500);\n"},"line_number":122,"absolute_offset":5392,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"        }\n"},"line_number":123,"absolute_offset":5413,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    }\n"},"line_number":124,"absolute_offset":5423,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":125,"absolute_offset":5429,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    /**\n"},"line_number":126,"absolute_offset":5430,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"     * Get a specific HOD-approved combined access request by ID\n"},"line_number":127,"absolute_offset":5438,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"     */\n"},"line_number":128,"absolute_offset":5503,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    public function show($id): JsonResponse\n"},"line_number":129,"absolute_offset":5511,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"    {\n"},"line_number":130,"absolute_offset":5555,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"        try {\n"},"line_number":131,"absolute_offset":5561,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            Log::info('Divisional Combined Access: Fetching specific request', [\n"},"line_number":132,"absolute_offset":5575,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'request_id' => $id,\n"},"line_number":133,"absolute_offset":5656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'user_id' => auth()->id()\n"},"line_number":134,"absolute_offset":5693,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":135,"absolute_offset":5735,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":136,"absolute_offset":5751,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $request = UserAccess::with(['user', 'department'])\n"},"line_number":137,"absolute_offset":5752,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ->findOrFail($id);\n"},"line_number":138,"absolute_offset":5816,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":139,"absolute_offset":5851,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            // DEPARTMENT AUTHORIZATION: Ensure Divisional Director can only access requests from their department(s)\n"},"line_number":140,"absolute_offset":5852,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $currentUser = auth()->user();\n"},"line_number":141,"absolute_offset":5970,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $divisionalDepartmentIds = $currentUser->departmentsAsDivisionalDirector()->pluck('id')->toArray();\n"},"line_number":142,"absolute_offset":6013,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            \n"},"line_number":143,"absolute_offset":6125,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            if (!empty($divisionalDepartmentIds) && !in_array($request->department_id, $divisionalDepartmentIds)) {\n"},"line_number":144,"absolute_offset":6138,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                Log::warning('Divisional Access Denied: Request not from Divisional Director department', [\n"},"line_number":145,"absolute_offset":6254,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'user_id' => $currentUser->id,\n"},"line_number":146,"absolute_offset":6362,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'request_department_id' => $request->department_id,\n"},"line_number":147,"absolute_offset":6413,"submatches":[{"match":{"text":"department_id' ="},"start":29,"end":45}]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'divisional_department_ids' => $divisionalDepartmentIds\n"},"line_number":148,"absolute_offset":6485,"submatches":[{"match":{"text":"department_ids' ="},"start":32,"end":49}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":149,"absolute_offset":6561,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                \n"},"line_number":150,"absolute_offset":6581,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":151,"absolute_offset":6598,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":152,"absolute_offset":6640,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'message' => 'Access denied. You can only view requests from your department.',\n"},"line_number":153,"absolute_offset":6680,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'error' => 'Unauthorized access'\n"},"line_number":154,"absolute_offset":6780,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ], 403);\n"},"line_number":155,"absolute_offset":6833,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            }\n"},"line_number":156,"absolute_offset":6858,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":157,"absolute_offset":6872,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            // Ensure request is HOD-approved before divisional can access it\n"},"line_number":158,"absolute_offset":6873,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            if (!in_array($request->status, ['hod_approved', 'divisional_approved', 'divisional_rejected'])) {\n"},"line_number":159,"absolute_offset":6951,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                Log::warning('Divisional Access Denied: Request not HOD-approved', [\n"},"line_number":160,"absolute_offset":7062,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'request_id' => $id,\n"},"line_number":161,"absolute_offset":7147,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'status' => $request->status\n"},"line_number":162,"absolute_offset":7188,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ]);\n"},"line_number":163,"absolute_offset":7237,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                \n"},"line_number":164,"absolute_offset":7257,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":165,"absolute_offset":7274,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":166,"absolute_offset":7316,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'message' => 'Access denied. Request must be HOD-approved first.',\n"},"line_number":167,"absolute_offset":7356,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                    'error' => 'Request not ready for divisional approval'\n"},"line_number":168,"absolute_offset":7443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                ], 403);\n"},"line_number":169,"absolute_offset":7518,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            }\n"},"line_number":170,"absolute_offset":7543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":171,"absolute_offset":7557,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            $transformedData = $this->transformRequestData($request);\n"},"line_number":172,"absolute_offset":7558,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":173,"absolute_offset":7628,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            Log::info('Divisional Combined Access: Request retrieved successfully', [\n"},"line_number":174,"absolute_offset":7629,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"                'request_id' => $id\n"},"line_number":175,"absolute_offset":7715,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":176,"absolute_offset":7751,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"\n"},"line_number":177,"absolute_offset":7767,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":178,"absolute_offset":7768,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DivisionalCombinedAccessController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":228300,"human":"0.000228s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":31432,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":559,"absolute_offset":21917,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            ], 500);\n"},"line_number":560,"absolute_offset":22009,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"        }\n"},"line_number":561,"absolute_offset":22030,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"    }\n"},"line_number":562,"absolute_offset":22040,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"\n"},"line_number":563,"absolute_offset":22046,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"    /**\n"},"line_number":564,"absolute_offset":22047,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     * Transform booking data for ICT approval system\n"},"line_number":565,"absolute_offset":22055,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     * \n"},"line_number":566,"absolute_offset":22109,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     * @param BookingService $booking\n"},"line_number":567,"absolute_offset":22117,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     * @param bool $includeDetails\n"},"line_number":568,"absolute_offset":22155,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     * @return array\n"},"line_number":569,"absolute_offset":22190,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"     */\n"},"line_number":570,"absolute_offset":22211,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"    private function transformBookingForICTApproval(BookingService $booking, bool $includeDetails = false): array\n"},"line_number":571,"absolute_offset":22219,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"    {\n"},"line_number":572,"absolute_offset":22333,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"        $user = $booking->user;\n"},"line_number":573,"absolute_offset":22339,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"        $department = $user->department ?? $booking->departmentInfo;\n"},"line_number":574,"absolute_offset":22371,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"\n"},"line_number":575,"absolute_offset":22440,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"        $data = [\n"},"line_number":576,"absolute_offset":22441,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Core request data\n"},"line_number":577,"absolute_offset":22459,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'id' => $booking->id,\n"},"line_number":578,"absolute_offset":22492,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'request_id' => 'REQ-' . str_pad($booking->id, 6, '0', STR_PAD_LEFT),\n"},"line_number":579,"absolute_offset":22526,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":580,"absolute_offset":22608,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Auto-captured user details from users/staff table\n"},"line_number":581,"absolute_offset":22621,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'borrower_id' => $booking->user_id,\n"},"line_number":582,"absolute_offset":22686,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'borrower_name' => $user->name ?? $booking->borrower_name ?? 'Unknown User',\n"},"line_number":583,"absolute_offset":22734,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'borrower_email' => $user->email ?? null,\n"},"line_number":584,"absolute_offset":22823,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'borrower_phone' => $user->phone ?? $booking->phone_number ?? null, // Always prioritize users.phone\n"},"line_number":585,"absolute_offset":22877,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'pf_number' => $user->pf_number ?? null,\n"},"line_number":586,"absolute_offset":22990,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":587,"absolute_offset":23043,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Department details\n"},"line_number":588,"absolute_offset":23056,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'department_id' => $department->id ?? null,\n"},"line_number":589,"absolute_offset":23090,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'department' => $department->name ?? 'Unknown Department',\n"},"line_number":590,"absolute_offset":23146,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":591,"absolute_offset":23217,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Device details\n"},"line_number":592,"absolute_offset":23230,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'device_type' => $booking->device_type,\n"},"line_number":593,"absolute_offset":23260,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'custom_device' => $booking->custom_device,\n"},"line_number":594,"absolute_offset":23312,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'device_name' => $this->getDeviceDisplayName($booking->device_type, $booking->custom_device, $booking->deviceInventory),\n"},"line_number":595,"absolute_offset":23368,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'device_inventory_id' => $booking->device_inventory_id,\n"},"line_number":596,"absolute_offset":23501,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'device_available' => $booking->deviceInventory ? $booking->deviceInventory->is_active : false,\n"},"line_number":597,"absolute_offset":23569,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":598,"absolute_offset":23677,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Booking details\n"},"line_number":599,"absolute_offset":23690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'booking_date' => $booking->booking_date?->format('Y-m-d'),\n"},"line_number":600,"absolute_offset":23721,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'collection_date' => $booking->return_date?->format('Y-m-d'), // Note: return_date is actually collection date\n"},"line_number":601,"absolute_offset":23793,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'return_date' => $booking->return_date?->format('Y-m-d'),\n"},"line_number":602,"absolute_offset":23916,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'return_time' => $booking->return_time,\n"},"line_number":603,"absolute_offset":23986,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'purpose' => $booking->reason,\n"},"line_number":604,"absolute_offset":24038,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":605,"absolute_offset":24081,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Signature details\n"},"line_number":606,"absolute_offset":24094,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'signature' => $booking->signature_path ? true : false,\n"},"line_number":607,"absolute_offset":24127,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'signature_path' => $booking->signature_path,\n"},"line_number":608,"absolute_offset":24195,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'signature_url' => $booking->signature_url,\n"},"line_number":609,"absolute_offset":24253,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'has_signature' => !empty($booking->signature_path),\n"},"line_number":610,"absolute_offset":24309,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            \n"},"line_number":611,"absolute_offset":24374,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            // Status and approval\n"},"line_number":612,"absolute_offset":24387,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'status' => $booking->status,\n"},"line_number":613,"absolute_offset":24422,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_status' => $booking->ict_approve ?? 'pending', // ICT-specific approval status\n"},"line_number":614,"absolute_offset":24464,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_approve' => $booking->ict_approve ?? 'pending', // For compatibility\n"},"line_number":615,"absolute_offset":24560,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_approval_date' => $booking->ict_approved_at?->format('Y-m-d H:i:s'),\n"},"line_number":616,"absolute_offset":24646,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_notes' => $booking->ict_notes,\n"},"line_number":617,"absolute_offset":24732,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_approved_by' => $booking->ict_approved_by,\n"},"line_number":618,"absolute_offset":24780,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"lines":{"text":"            'ict_approved_by_name' => $booking->ictApprovedBy?->name,\n"},"line_number":619,"absolute_offset":24840,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ICTApprovalController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":161200,"human":"0.000161s"},"searches":1,"searches_with_match":1,"bytes_searched":58901,"bytes_printed":14933,"matched_lines":1,"matches":1}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            }\n"},"line_number":55,"absolute_offset":1719,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":56,"absolute_offset":1733,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Sorting\n"},"line_number":57,"absolute_offset":1734,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $sortBy = $request->get('sort_by', 'name');\n"},"line_number":58,"absolute_offset":1757,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $sortOrder = $request->get('sort_order', 'asc');\n"},"line_number":59,"absolute_offset":1813,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":60,"absolute_offset":1874,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            if (in_array($sortBy, ['name', 'code', 'created_at'])) {\n"},"line_number":61,"absolute_offset":1887,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                $query->orderBy($sortBy, $sortOrder);\n"},"line_number":62,"absolute_offset":1956,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            } else {\n"},"line_number":63,"absolute_offset":2010,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                $query->orderBy('name', 'asc');\n"},"line_number":64,"absolute_offset":2031,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            }\n"},"line_number":65,"absolute_offset":2079,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":66,"absolute_offset":2093,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Include request counts for each department\n"},"line_number":67,"absolute_offset":2094,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $query->withCount(['userAccessRequests as pending_requests_count' => function ($q) {\n"},"line_number":68,"absolute_offset":2152,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                $q->where('status', 'pending');\n"},"line_number":69,"absolute_offset":2249,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            }]);\n"},"line_number":70,"absolute_offset":2297,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":71,"absolute_offset":2314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Pagination\n"},"line_number":72,"absolute_offset":2315,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $perPage = min($request->get('per_page', 15), 100);\n"},"line_number":73,"absolute_offset":2341,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $departments = $query->paginate($perPage);\n"},"line_number":74,"absolute_offset":2405,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":75,"absolute_offset":2460,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Transform the data\n"},"line_number":76,"absolute_offset":2461,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $departments->getCollection()->transform(function ($department) {\n"},"line_number":77,"absolute_offset":2495,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                return [\n"},"line_number":78,"absolute_offset":2573,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'id' => $department->id,\n"},"line_number":79,"absolute_offset":2598,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'name' => $department->name,\n"},"line_number":80,"absolute_offset":2643,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'code' => $department->code,\n"},"line_number":81,"absolute_offset":2692,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'description' => $department->description,\n"},"line_number":82,"absolute_offset":2741,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'is_active' => $department->is_active,\n"},"line_number":83,"absolute_offset":2804,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'level' => $department->level ?? 1,\n"},"line_number":84,"absolute_offset":2863,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'parent_department_id' => $department->parent_department_id,\n"},"line_number":85,"absolute_offset":2919,"submatches":[{"match":{"text":"department_id' ="},"start":28,"end":44}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'pending_requests_count' => $department->pending_requests_count,\n"},"line_number":86,"absolute_offset":3000,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'hod' => $department->headOfDepartment ? [\n"},"line_number":87,"absolute_offset":3085,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                        'id' => $department->headOfDepartment->id,\n"},"line_number":88,"absolute_offset":3148,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                        'name' => $department->headOfDepartment->name,\n"},"line_number":89,"absolute_offset":3215,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                        'email' => $department->headOfDepartment->email,\n"},"line_number":90,"absolute_offset":3286,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                        'pf_number' => $department->headOfDepartment->pf_number,\n"},"line_number":91,"absolute_offset":3359,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                        'roles' => $department->headOfDepartment->roles->pluck('name')->toArray(),\n"},"line_number":92,"absolute_offset":3440,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    ] : null,\n"},"line_number":93,"absolute_offset":3539,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'created_at' => $department->created_at,\n"},"line_number":94,"absolute_offset":3569,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'updated_at' => $department->updated_at,\n"},"line_number":95,"absolute_offset":3630,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                ];\n"},"line_number":96,"absolute_offset":3691,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            });\n"},"line_number":97,"absolute_offset":3710,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":98,"absolute_offset":3726,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":99,"absolute_offset":3727,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":100,"absolute_offset":3765,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'data' => $departments,\n"},"line_number":101,"absolute_offset":3800,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => 'Departments retrieved successfully.'\n"},"line_number":102,"absolute_offset":3840,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]);\n"},"line_number":103,"absolute_offset":3907,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":104,"absolute_offset":3923,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":105,"absolute_offset":3924,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            Log::error('Error retrieving departments: ' . $e->getMessage());\n"},"line_number":106,"absolute_offset":3958,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":107,"absolute_offset":4035,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":108,"absolute_offset":4048,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":109,"absolute_offset":4086,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => 'Failed to retrieve departments.',\n"},"line_number":110,"absolute_offset":4122,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":111,"absolute_offset":4186,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ], 500);\n"},"line_number":112,"absolute_offset":4278,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        }\n"},"line_number":113,"absolute_offset":4299,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    }\n"},"line_number":114,"absolute_offset":4309,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":115,"absolute_offset":4315,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'exists:users,id',\n"},"line_number":125,"absolute_offset":4574,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                Rule::unique('departments', 'hod_user_id')->ignore($department->id),\n"},"line_number":126,"absolute_offset":4609,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]\n"},"line_number":127,"absolute_offset":4694,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        ], [\n"},"line_number":128,"absolute_offset":4708,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            'hod_user_id.required' => 'HOD user is required.',\n"},"line_number":129,"absolute_offset":4721,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            'hod_user_id.exists' => 'Selected user does not exist.',\n"},"line_number":130,"absolute_offset":4784,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            'hod_user_id.unique' => 'This user is already assigned as HOD to another department.',\n"},"line_number":131,"absolute_offset":4853,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        ]);\n"},"line_number":132,"absolute_offset":4952,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":133,"absolute_offset":4964,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        DB::beginTransaction();\n"},"line_number":134,"absolute_offset":4965,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        \n"},"line_number":135,"absolute_offset":4997,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        try {\n"},"line_number":136,"absolute_offset":5006,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $hodUser = User::findOrFail($request->hod_user_id);\n"},"line_number":137,"absolute_offset":5020,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $currentUser = $request->user();\n"},"line_number":138,"absolute_offset":5084,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":139,"absolute_offset":5129,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Check if user has appropriate role\n"},"line_number":140,"absolute_offset":5130,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            if (!$hodUser->hasAnyRole(['head_of_department', 'ict_director', 'admin'])) {\n"},"line_number":141,"absolute_offset":5180,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":142,"absolute_offset":5270,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":143,"absolute_offset":5312,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'message' => 'Selected user does not have appropriate role to be HOD.'\n"},"line_number":144,"absolute_offset":5352,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                ], 422);\n"},"line_number":145,"absolute_offset":5443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            }\n"},"line_number":146,"absolute_offset":5468,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":147,"absolute_offset":5482,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $previousHodId = $department->hod_user_id;\n"},"line_number":148,"absolute_offset":5483,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":149,"absolute_offset":5538,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Update department\n"},"line_number":150,"absolute_offset":5551,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $department->update(['hod_user_id' => $hodUser->id]);\n"},"line_number":151,"absolute_offset":5584,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":152,"absolute_offset":5650,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Log the change\n"},"line_number":153,"absolute_offset":5651,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            Log::info('HOD assigned to department', [\n"},"line_number":154,"absolute_offset":5681,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'department_id' => $department->id,\n"},"line_number":155,"absolute_offset":5735,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'department_name' => $department->name,\n"},"line_number":156,"absolute_offset":5787,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'new_hod_id' => $hodUser->id,\n"},"line_number":157,"absolute_offset":5843,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'new_hod_email' => $hodUser->email,\n"},"line_number":158,"absolute_offset":5889,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'previous_hod_id' => $previousHodId,\n"},"line_number":159,"absolute_offset":5941,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'assigned_by' => $currentUser->id\n"},"line_number":160,"absolute_offset":5994,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]);\n"},"line_number":161,"absolute_offset":6044,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":162,"absolute_offset":6060,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            DB::commit();\n"},"line_number":163,"absolute_offset":6061,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":164,"absolute_offset":6087,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Return updated department\n"},"line_number":165,"absolute_offset":6088,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $department->load('headOfDepartment.roles');\n"},"line_number":166,"absolute_offset":6129,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":167,"absolute_offset":6186,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":168,"absolute_offset":6187,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":169,"absolute_offset":6225,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'data' => $department,\n"},"line_number":170,"absolute_offset":6260,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => \"HOD assigned to {$department->name} successfully.\"\n"},"line_number":171,"absolute_offset":6299,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]);\n"},"line_number":172,"absolute_offset":6380,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":173,"absolute_offset":6396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":174,"absolute_offset":6397,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            DB::rollBack();\n"},"line_number":175,"absolute_offset":6431,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            Log::error('Error assigning HOD: ' . $e->getMessage());\n"},"line_number":176,"absolute_offset":6459,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":177,"absolute_offset":6527,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":178,"absolute_offset":6540,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":179,"absolute_offset":6578,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => 'Failed to assign HOD.',\n"},"line_number":180,"absolute_offset":6614,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":181,"absolute_offset":6668,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ], 500);\n"},"line_number":182,"absolute_offset":6760,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        }\n"},"line_number":183,"absolute_offset":6781,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    }\n"},"line_number":184,"absolute_offset":6791,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":185,"absolute_offset":6797,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    /**\n"},"line_number":186,"absolute_offset":6798,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"     * Remove HOD from a department.\n"},"line_number":187,"absolute_offset":6806,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"     */\n"},"line_number":188,"absolute_offset":6843,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    public function removeHod(Request $request, Department $department): JsonResponse\n"},"line_number":189,"absolute_offset":6851,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    {\n"},"line_number":190,"absolute_offset":6937,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        DB::beginTransaction();\n"},"line_number":191,"absolute_offset":6943,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        \n"},"line_number":192,"absolute_offset":6975,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        try {\n"},"line_number":193,"absolute_offset":6984,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            if (!$department->hod_user_id) {\n"},"line_number":194,"absolute_offset":6998,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":195,"absolute_offset":7043,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":196,"absolute_offset":7085,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                    'message' => 'Department does not have an assigned HOD.'\n"},"line_number":197,"absolute_offset":7125,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                ], 422);\n"},"line_number":198,"absolute_offset":7202,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            }\n"},"line_number":199,"absolute_offset":7227,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":200,"absolute_offset":7241,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $previousHodId = $department->hod_user_id;\n"},"line_number":201,"absolute_offset":7242,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $previousHod = $department->headOfDepartment;\n"},"line_number":202,"absolute_offset":7297,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":203,"absolute_offset":7355,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Remove HOD assignment\n"},"line_number":204,"absolute_offset":7368,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            $department->update(['hod_user_id' => null]);\n"},"line_number":205,"absolute_offset":7405,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":206,"absolute_offset":7463,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            // Log the change\n"},"line_number":207,"absolute_offset":7464,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            Log::info('HOD removed from department', [\n"},"line_number":208,"absolute_offset":7494,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'department_id' => $department->id,\n"},"line_number":209,"absolute_offset":7549,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'department_name' => $department->name,\n"},"line_number":210,"absolute_offset":7601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'previous_hod_id' => $previousHodId,\n"},"line_number":211,"absolute_offset":7657,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'previous_hod_email' => $previousHod?->email,\n"},"line_number":212,"absolute_offset":7710,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'removed_by' => $request->user()->id\n"},"line_number":213,"absolute_offset":7772,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]);\n"},"line_number":214,"absolute_offset":7825,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":215,"absolute_offset":7841,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            DB::commit();\n"},"line_number":216,"absolute_offset":7842,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":217,"absolute_offset":7868,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":218,"absolute_offset":7869,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":219,"absolute_offset":7907,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => \"HOD removed from {$department->name} successfully.\"\n"},"line_number":220,"absolute_offset":7942,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ]);\n"},"line_number":221,"absolute_offset":8024,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":222,"absolute_offset":8040,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":223,"absolute_offset":8041,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            DB::rollBack();\n"},"line_number":224,"absolute_offset":8075,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            Log::error('Error removing HOD: ' . $e->getMessage());\n"},"line_number":225,"absolute_offset":8103,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            \n"},"line_number":226,"absolute_offset":8170,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":227,"absolute_offset":8183,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":228,"absolute_offset":8221,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'message' => 'Failed to remove HOD.',\n"},"line_number":229,"absolute_offset":8257,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":230,"absolute_offset":8311,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"            ], 500);\n"},"line_number":231,"absolute_offset":8403,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"        }\n"},"line_number":232,"absolute_offset":8424,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    }\n"},"line_number":233,"absolute_offset":8434,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"\n"},"line_number":234,"absolute_offset":8440,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    /**\n"},"line_number":235,"absolute_offset":8441,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"     * Get eligible HOD users - all users from users table excluding those who are already HODs.\n"},"line_number":236,"absolute_offset":8449,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"     */\n"},"line_number":237,"absolute_offset":8546,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    public function eligibleHods(): JsonResponse\n"},"line_number":238,"absolute_offset":8554,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"lines":{"text":"    {\n"},"line_number":239,"absolute_offset":8603,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\DepartmentHodController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":506600,"human":"0.000507s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":41017,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"        \n"},"line_number":275,"absolute_offset":10598,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"        // If approved, move to next stage\n"},"line_number":276,"absolute_offset":10607,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"        switch ($stage) {\n"},"line_number":277,"absolute_offset":10650,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            case 'hod':\n"},"line_number":278,"absolute_offset":10676,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'hod_approved';\n"},"line_number":279,"absolute_offset":10700,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            case 'divisional_director':\n"},"line_number":280,"absolute_offset":10739,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'divisional_approved';\n"},"line_number":281,"absolute_offset":10779,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            case 'ict_director':\n"},"line_number":282,"absolute_offset":10825,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'ict_director_approved';\n"},"line_number":283,"absolute_offset":10858,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            case 'head_it':\n"},"line_number":284,"absolute_offset":10906,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'head_it_approved';\n"},"line_number":285,"absolute_offset":10934,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            case 'ict_officer':\n"},"line_number":286,"absolute_offset":10977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'implemented';\n"},"line_number":287,"absolute_offset":11009,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            default:\n"},"line_number":288,"absolute_offset":11047,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                return 'approved';\n"},"line_number":289,"absolute_offset":11068,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"        }\n"},"line_number":290,"absolute_offset":11103,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"    }\n"},"line_number":291,"absolute_offset":11113,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"    \n"},"line_number":292,"absolute_offset":11119,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"    /**\n"},"line_number":293,"absolute_offset":11124,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"     * Transform request data for approval form display\n"},"line_number":294,"absolute_offset":11132,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"     */\n"},"line_number":295,"absolute_offset":11188,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"    private function transformRequestForApproval($userAccess): array\n"},"line_number":296,"absolute_offset":11196,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"    {\n"},"line_number":297,"absolute_offset":11265,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"        return [\n"},"line_number":298,"absolute_offset":11271,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'id' => $userAccess->id,\n"},"line_number":299,"absolute_offset":11288,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'request_id' => 'REQ-' . str_pad($userAccess->id, 6, '0', STR_PAD_LEFT),\n"},"line_number":300,"absolute_offset":11325,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'staff_name' => $userAccess->staff_name,\n"},"line_number":301,"absolute_offset":11410,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'pf_number' => $userAccess->pf_number,\n"},"line_number":302,"absolute_offset":11463,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'phone_number' => $userAccess->phone_number,\n"},"line_number":303,"absolute_offset":11514,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'department' => $userAccess->department?->name,\n"},"line_number":304,"absolute_offset":11571,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'department_id' => $userAccess->department_id,\n"},"line_number":305,"absolute_offset":11631,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'request_type' => $userAccess->request_type,\n"},"line_number":306,"absolute_offset":11690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'purpose' => $userAccess->purpose,\n"},"line_number":307,"absolute_offset":11747,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'status' => $userAccess->status,\n"},"line_number":308,"absolute_offset":11794,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'signature_path' => $userAccess->signature_path,\n"},"line_number":309,"absolute_offset":11839,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            \n"},"line_number":310,"absolute_offset":11900,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            // Module form data\n"},"line_number":311,"absolute_offset":11913,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'module_requested_for' => $userAccess->module_requested_for ?? 'use',\n"},"line_number":312,"absolute_offset":11945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'wellsoft_modules' => $userAccess->wellsoft_modules ?? [],\n"},"line_number":313,"absolute_offset":12027,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'jeeva_modules' => $userAccess->jeeva_modules ?? [],\n"},"line_number":314,"absolute_offset":12098,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'wellsoft_modules_selected' => $userAccess->wellsoft_modules_selected ?? [],\n"},"line_number":315,"absolute_offset":12163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'jeeva_modules_selected' => $userAccess->jeeva_modules_selected ?? [],\n"},"line_number":316,"absolute_offset":12252,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'internet_purposes' => $userAccess->internet_purposes ?? [],\n"},"line_number":317,"absolute_offset":12335,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'access_type' => $userAccess->access_type ?? 'permanent',\n"},"line_number":318,"absolute_offset":12408,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'temporary_until' => $userAccess->temporary_until?->format('Y-m-d'),\n"},"line_number":319,"absolute_offset":12478,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            \n"},"line_number":320,"absolute_offset":12559,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            // Approval trail\n"},"line_number":321,"absolute_offset":12572,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'hod_approval' => [\n"},"line_number":322,"absolute_offset":12602,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'name' => $userAccess->hod_name,\n"},"line_number":323,"absolute_offset":12634,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'comments' => $userAccess->hod_comments,\n"},"line_number":324,"absolute_offset":12683,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'approved_at' => $userAccess->hod_approved_at?->format('Y-m-d H:i:s'),\n"},"line_number":325,"absolute_offset":12740,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            ],\n"},"line_number":326,"absolute_offset":12827,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'divisional_approval' => [\n"},"line_number":327,"absolute_offset":12842,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'name' => $userAccess->divisional_director_name,\n"},"line_number":328,"absolute_offset":12881,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'comments' => $userAccess->divisional_director_comments,\n"},"line_number":329,"absolute_offset":12946,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'approved_at' => $userAccess->divisional_approved_at?->format('Y-m-d H:i:s'),\n"},"line_number":330,"absolute_offset":13019,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            ],\n"},"line_number":331,"absolute_offset":13113,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"            'ict_director_approval' => [\n"},"line_number":332,"absolute_offset":13128,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'name' => $userAccess->ict_director_name,\n"},"line_number":333,"absolute_offset":13169,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'comments' => $userAccess->ict_director_comments,\n"},"line_number":334,"absolute_offset":13227,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"lines":{"text":"                'approved_at' => $userAccess->ict_director_approved_at?->format('Y-m-d H:i:s'),\n"},"line_number":335,"absolute_offset":13293,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\ModuleAccessApprovalController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":129800,"human":"0.000130s"},"searches":1,"searches_with_match":1,"bytes_searched":14213,"bytes_printed":15289,"matched_lines":1,"matches":1}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'temporary_until' => 'required_if:access_type,temporary|nullable|date|after:today',\n"},"line_number":51,"absolute_offset":1993,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                // Module selection validation\n"},"line_number":52,"absolute_offset":2093,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'wellsoft_modules_selected' => 'sometimes|array',\n"},"line_number":53,"absolute_offset":2140,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'wellsoft_modules_selected.*' => 'string',\n"},"line_number":54,"absolute_offset":2206,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'jeeva_modules_selected' => 'sometimes|array', \n"},"line_number":55,"absolute_offset":2265,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'jeeva_modules_selected.*' => 'string',\n"},"line_number":56,"absolute_offset":2329,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'module_requested_for' => 'sometimes|string|in:use,revoke',\n"},"line_number":57,"absolute_offset":2385,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            ], [\n"},"line_number":58,"absolute_offset":2461,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'hod_name.required' => 'HOD name is required',\n"},"line_number":59,"absolute_offset":2478,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'hod_signature.required' => 'HOD signature file is required',\n"},"line_number":60,"absolute_offset":2541,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'hod_signature.mimes' => 'Signature must be in JPEG, JPG, PNG, or PDF format',\n"},"line_number":61,"absolute_offset":2619,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'hod_signature.max' => 'Signature file must not exceed 2MB',\n"},"line_number":62,"absolute_offset":2714,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'approved_date.required' => 'Approval date is required',\n"},"line_number":63,"absolute_offset":2791,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'approved_date.date' => 'Please provide a valid approval date',\n"},"line_number":64,"absolute_offset":2864,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'access_type.required' => 'Access type (permanent/temporary) is required',\n"},"line_number":65,"absolute_offset":2944,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'access_type.in' => 'Access type must be either permanent or temporary',\n"},"line_number":66,"absolute_offset":3035,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'temporary_until.required_if' => 'End date is required for temporary access',\n"},"line_number":67,"absolute_offset":3124,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'temporary_until.after' => 'End date must be in the future',\n"},"line_number":68,"absolute_offset":3218,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            ]);\n"},"line_number":69,"absolute_offset":3295,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":70,"absolute_offset":3311,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            Log::info('✅ Validation passed', [\n"},"line_number":71,"absolute_offset":3324,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'validated_data' => array_except($validated, ['hod_signature']),\n"},"line_number":72,"absolute_offset":3373,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'has_signature_file' => isset($validated['hod_signature'])\n"},"line_number":73,"absolute_offset":3454,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            ]);\n"},"line_number":74,"absolute_offset":3529,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":75,"absolute_offset":3545,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            // Get user access record\n"},"line_number":76,"absolute_offset":3558,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            $userAccess = UserAccess::findOrFail($userAccessId);\n"},"line_number":77,"absolute_offset":3596,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":78,"absolute_offset":3661,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            // Verify HOD can approve this request (from their department)\n"},"line_number":79,"absolute_offset":3674,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            $hodDepartment = Department::where('hod_user_id', $currentUser->id)->first();\n"},"line_number":80,"absolute_offset":3749,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            if (!$hodDepartment || $userAccess->department_id !== $hodDepartment->id) {\n"},"line_number":81,"absolute_offset":3839,"submatches":[{"match":{"text":"department_id !=="},"start":48,"end":65}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                return response()->json([\n"},"line_number":82,"absolute_offset":3927,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":83,"absolute_offset":3969,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    'message' => 'Access denied. You can only approve requests from your department.'\n"},"line_number":84,"absolute_offset":4009,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                ], 403);\n"},"line_number":85,"absolute_offset":4111,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            }\n"},"line_number":86,"absolute_offset":4136,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":87,"absolute_offset":4150,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            Log::info('🏢 Department verification passed', [\n"},"line_number":88,"absolute_offset":4163,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'hod_department_id' => $hodDepartment->id,\n"},"line_number":89,"absolute_offset":4226,"submatches":[{"match":{"text":"department_id' ="},"start":21,"end":37}]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'request_department_id' => $userAccess->department_id,\n"},"line_number":90,"absolute_offset":4285,"submatches":[{"match":{"text":"department_id' ="},"start":25,"end":41}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                'department_name' => $hodDepartment->name\n"},"line_number":91,"absolute_offset":4356,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            ]);\n"},"line_number":92,"absolute_offset":4414,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":93,"absolute_offset":4430,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            DB::beginTransaction();\n"},"line_number":94,"absolute_offset":4443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            \n"},"line_number":95,"absolute_offset":4479,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            // FIXED: Handle signature upload with proper error handling\n"},"line_number":96,"absolute_offset":4492,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            $hodSignaturePath = null;\n"},"line_number":97,"absolute_offset":4565,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"            if ($request->hasFile('hod_signature')) {\n"},"line_number":98,"absolute_offset":4603,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                try {\n"},"line_number":99,"absolute_offset":4657,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    $hodSignatureFile = $request->file('hod_signature');\n"},"line_number":100,"absolute_offset":4679,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    \n"},"line_number":101,"absolute_offset":4752,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    // Validate file before processing\n"},"line_number":102,"absolute_offset":4773,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    if (!$hodSignatureFile->isValid()) {\n"},"line_number":103,"absolute_offset":4828,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                        throw new \\Exception('Uploaded signature file is invalid');\n"},"line_number":104,"absolute_offset":4885,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    }\n"},"line_number":105,"absolute_offset":4969,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    \n"},"line_number":106,"absolute_offset":4991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    // Create directory if it doesn't exist\n"},"line_number":107,"absolute_offset":5012,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    $signatureDir = 'signatures/hod';\n"},"line_number":108,"absolute_offset":5072,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"lines":{"text":"                    if (!Storage::disk('public')->exists($signatureDir)) {\\n                        Storage::disk('public')->makeDirectory($signatureDir);\\n                    }\\n                    \\n                    // Generate unique filename\\n                    $filename = 'hod_signature_' . $userAccess->pf_number . '_' . time() . '.' . $hodSignatureFile->getClientOriginalExtension();\\n                    \\n                    // Store the file\\n                    $hodSignaturePath = $hodSignatureFile->storeAs($signatureDir, $filename, 'public');\\n                    \\n                    // Verify file was actually stored\\n                    if (!Storage::disk('public')->exists($hodSignaturePath)) {\\n                        throw new \\\\Exception('Failed to store signature file');\\n                    }\\n                    \\n                    Log::info('✅ HOD signature uploaded successfully', [\\n                        'original_name' => $hodSignatureFile->getClientOriginalName(),\\n                        'stored_path' => $hodSignaturePath,\\n                        'file_size' => $hodSignatureFile->getSize(),\\n                        'mime_type' => $hodSignatureFile->getMimeType()\\n                    ]);\\n                    \\n                } catch (\\\\Exception $e) {\\n                    Log::error('❌ HOD signature upload failed', [\\n                        'error' => $e->getMessage(),\\n                        'file_info' => [\\n                            'name' => $request->file('hod_signature')->getClientOriginalName(),\\n                            'size' => $request->file('hod_signature')->getSize(),\\n                            'mime' => $request->file('hod_signature')->getMimeType()\\n                        ]\\n                    ]);\\n                    \\n                    DB::rollBack();\\n                    return response()->json([\\n                        'success' => false,\\n                        'message' => 'Failed to upload HOD signature: ' . $e->getMessage()\\n                    ], 500);\\n                }\\n            } else {\\n                Log::error('❌ No HOD signature file provided', [\\n                    'has_file' => $request->hasFile('hod_signature'),\\n                    'files' => $request->allFiles()\\n                ]);\\n                \\n                DB::rollBack();\\n                return response()->json([\\n                    'success' => false,\\n                    'message' => 'HOD signature file is required'\\n                ], 422);\\n            }\\n            \\n            // FIXED: Process module selections properly\\n            $updateData = [\\n                'hod_name' => $validated['hod_name'],\\n                'hod_signature_path' => $hodSignaturePath,\\n                'hod_approved_at' => $validated['approved_date'],\\n                'hod_comments' => $validated['comments'] ?? null,\\n                'hod_approved_by' => $currentUser->id,\\n                'hod_approved_by_name' => $currentUser->name,\\n                'access_type' => $validated['access_type'],\\n                'temporary_until' => $validated['access_type'] === 'temporary' ? $validated['temporary_until'] : null,\\n                'status' => 'hod_approved'\\n            ];\\n            \\n            // FIXED: Handle module selections if provided\\n            if ($request->has('wellsoft_modules_selected')) {\\n                $wellsoftModules = $request->input('wellsoft_modules_selected', []);\\n                if (is_array($wellsoftModules)) {\\n                    $updateData['wellsoft_modules'] = $wellsoftModules;\\n                    $updateData['wellsoft_modules_selected'] = $wellsoftModules;\\n                    \\n                    Log::info('✅ Wellsoft modules processed', [\\n                        'modules' => $wellsoftModules,\\n                        'count' => count($wellsoftModules)\\n                    ]);\\n                }\\n            }\\n            \\n            if ($request->has('jeeva_modules_selected')) {\\n                $jeevaModules = $request->input('jeeva_modules_selected', []);\\n                if (is_array($jeevaModules)) {\\n                    $updateData['jeeva_modules'] = $jeevaModules;\\n                    $updateData['jeeva_modules_selected'] = $jeevaModules;\\n                    \\n                    Log::info('✅ Jeeva modules processed', [\\n                        'modules' => $jeevaModules,\\n                        'count' => count($jeevaModules)\\n                    ]);\\n                }\\n            }\\n            \\n            if ($request->has('module_requested_for')) {\\n                $updateData['module_requested_for'] = $request->input('module_requested_for', 'use');\\n                \\n                Log::info('✅ Module request type processed', [\\n                    'module_requested_for' => $updateData['module_requested_for']\\n                ]);\\n            }\\n            \\n            Log::info('🔄 Updating user access record', [\\n                'user_access_id' => $userAccess->id,\\n                'update_data' => array_except($updateData, ['hod_signature_path']),\\n                'has_signature_path' => !empty($updateData['hod_signature_path'])\\n            ]);\\n            \\n            // Update the user access record\\n            $userAccess->update($updateData);\\n            \\n            // Verify the update was successful\\n            $userAccess->refresh();\\n            \\n            Log::info('✅ User access record updated successfully', [\\n                'user_access_id' => $userAccess->id,\\n                'hod_name' => $userAccess->hod_name,\\n                'hod_signature_path' => $userAccess->hod_signature_path,\\n                'hod_approved_at' => $userAccess->hod_approved_at,\\n                'access_type' => $userAccess->access_type,\\n                'temporary_until' => $userAccess->temporary_until,\\n                'wellsoft_modules_count' => count($userAccess->wellsoft_modules ?? []),\\n                'jeeva_modules_count' => count($userAccess->jeeva_modules ?? []),\\n                'module_requested_for' => $userAccess->module_requested_for,\\n                'status' => $userAccess->status\\n            ]);\\n            \\n            DB::commit();\\n            \\n            // Load relationships for response\\n            $userAccess->load(['user', 'department']);\\n            \\n            return response()->json([\\n                'success' => true,\\n                'message' => 'HOD approval updated successfully.',\\n                'data' => [\\n                    'request_id' => $userAccess->id,\\n                    'status' => $userAccess->status,\\n                    'access_rights' => [\\n                        'type' => $userAccess->access_type,\\n                        'temporary_until' => $userAccess->temporary_until,\\n                        'description' => $userAccess->access_type === 'permanent' \\n                            ? 'Permanent (until retirement)' \\n                            : 'Temporary until ' . ($userAccess->temporary_until ? $userAccess->temporary_until->format('F j, Y') : 'N/A')\\n                    ],\\n                    'hod_approval' => [\\n                        'name' => $userAccess->hod_name,\\n                        'approved_at' => $userAccess->hod_approved_at->format('Y-m-d H:i:s'),\\n                        'approved_at_formatted' => $userAccess->hod_approved_at->format('m/d/Y'),\\n                        'comments' => $userAccess->hod_comments,\\n                        'signature_url' => Storage::url($userAccess->hod_signature_path),\\n                        'signature_path' => $userAccess->hod_signature_path,\\n                        'approved_by' => $userAccess->hod_approved_by_name\\n                    ],\\n                    'modules' => [\\n                        'wellsoft_modules' => $userAccess->wellsoft_modules ?? [],\\n                        'jeeva_modules' => $userAccess->jeeva_modules ?? [],\\n                        'wellsoft_modules_selected' => $userAccess->wellsoft_modules_selected ?? [],\\n                        'jeeva_modules_selected' => $userAccess->jeeva_modules_selected ?? [],\\n                        'module_requested_for' => $userAccess->module_requested_for,\\n                        'wellsoft_count' => count($userAccess->wellsoft_modules ?? []),\\n                        'jeeva_count' => count($userAccess->jeeva_modules ?? [])\\n                    ],\\n                    'next_step' => $userAccess->getNextApprovalNeeded()\\n                ]\\n            ]);\\n            \\n        } catch (ValidationException $e) {\\n            DB::rollBack();\\n            \\n            Log::error('❌ Validation failed for HOD approval', [\\n                'errors' => $e->errors(),\\n                'user_access_id' => $userAccessId\\n            ]);\\n            \\n            return response()->json([\\n                'success' => false,\\n                'message' => 'Validation failed',\\n                'errors' => $e->errors()\\n            ], 422);\\n        } catch (\\\\Exception $e) {\\n            DB::rollBack();\\n            \\n            Log::error('❌ Error updating HOD approval', [\\n                'error' => $e->getMessage(),\\n                'user_access_id' => $userAccessId,\\n                'current_user_id' => $request->user()?->id,\\n                'stack_trace' => $e->getTraceAsString()\\n            ]);\\n            \\n            return response()->json([\\n                'success' => false,\\n                'message' => 'Failed to update HOD approval: ' . $e->getMessage()\\n            ], 500);\\n        }\\n    }\\n    \\n    /**\\n     * FIXED: Enhanced show method with proper module data\\n     */\\n    public function show(Request $request, int $id): JsonResponse\\n    {\\n        try {\\n            $currentUser = $request->user();\\n            $userRoles = $currentUser->roles()->pluck('name')->toArray();\\n            \\n            // Get the user access request with relationships\\n            $userAccess = UserAccess::with(['user', 'department'])\\n                ->findOrFail($id);\\n            \\n            // Check permissions\\n            $allowedRoles = ['head_of_department', 'divisional_director', 'ict_director', 'ict_officer', 'admin', 'super_admin'];\\n            $canView = false;\\n            \\n            if ($userAccess->user_id === $currentUser->id) {\\n                $canView = true;\\n            } else if (array_intersect($userRoles, $allowedRoles)) {\\n                $canView = true;\\n                \\n                if (array_intersect($userRoles, ['head_of_department']) && !array_intersect($userRoles, ['admin', 'super_admin'])) {\\n                    $hodDepartment = Department::where('hod_user_id', $currentUser->id)->first();\\n                    if (!$hodDepartment || $userAccess->department_id !== $hodDepartment->id) {\\n                        $canView = false;\\n                    }\\n                }\\n            }\\n            \\n            if (!$canView) {\\n                return response()->json([\\n                    'success' => false,\\n                    'message' => 'Access denied.'\\n                ], 403);\\n            }\\n            \\n            // FIXED: Transform data with proper module information\\n            $transformedData = [\\n                'id' => $userAccess->id,\\n                'shared' => [\\n                    'pfNumber' => $userAccess->pf_number,\\n                    'staffName' => $userAccess->staff_name,\\n                    'department' => $userAccess->department?->name ?? '',\\n                    'phone' => $userAccess->phone_number,\\n                ],\\n                'signature_path' => $userAccess->signature_path,\\n                'signature_url' => $userAccess->signature_path ? Storage::url($userAccess->signature_path) : null,\\n                \\n                // FIXED: Proper module data\\n                'wellsoft_modules_selected' => $userAccess->wellsoft_modules_selected ?? [],\\n                'jeeva_modules_selected' => $userAccess->jeeva_modules_selected ?? [],\\n                'wellsoft_modules' => $userAccess->wellsoft_modules ?? [],\\n                'jeeva_modules' => $userAccess->jeeva_modules ?? [],\\n                'module_requested_for' => $userAccess->module_requested_for ?? 'use',\\n                \\n                'internet_purposes' => $userAccess->internet_purposes ?? [],\\n                'access_type' => $userAccess->access_type ?? 'permanent',\\n                'temporary_until' => $userAccess->temporary_until,\\n                'request_type' => $userAccess->request_type ?? [],\\n                'status' => $userAccess->status,\\n                \\n                // FIXED: Complete approval information\\n                'approvals' => [\\n                    'hod' => [\\n                        'name' => $userAccess->hod_name,\\n                        'signature' => $userAccess->hod_signature_path,\\n                        'signature_url' => $userAccess->hod_signature_path ? Storage::url($userAccess->hod_signature_path) : null,\\n                        'date' => $userAccess->hod_approved_at,\\n                        'comments' => $userAccess->hod_comments,\\n                        'approved_by' => $userAccess->hod_approved_by_name,\\n                        'has_signature' => !empty($userAccess->hod_signature_path),\\n                        'is_approved' => !empty($userAccess->hod_approved_at)\\n                    ],\\n                    'divisionalDirector' => [\\n                        'name' => $userAccess->divisional_director_name,\\n                        'signature' => $userAccess->divisional_director_signature_path,\\n                        'signature_url' => $userAccess->divisional_director_signature_path ? Storage::url($userAccess->divisional_director_signature_path) : null,\\n                        'date' => $userAccess->divisional_approved_at,\\n                        'comments' => $userAccess->divisional_director_comments,\\n                        'has_signature' => !empty($userAccess->divisional_director_signature_path),\\n                        'is_approved' => !empty($userAccess->divisional_approved_at)\\n                    ],\\n                    'directorICT' => [\\n                        'name' => $userAccess->ict_director_name,\\n                        'signature' => $userAccess->ict_director_signature_path,\\n                        'signature_url' => $userAccess->ict_director_signature_path ? Storage::url($userAccess->ict_director_signature_path) : null,\\n                        'date' => $userAccess->ict_director_approved_at,\\n                        'comments' => $userAccess->ict_director_comments,\\n                        'has_signature' => !empty($userAccess->ict_director_signature_path),\\n                        'is_approved' => !empty($userAccess->ict_director_approved_at)\\n                    ]\\n                ],\\n                \\n                // Implementation data\\n                'implementation' => [\\n                    'headIT' => [\\n                        'name' => $userAccess->head_it_name,\\n                        'signature' => $userAccess->head_it_signature_path,\\n                        'signature_url' => $userAccess->head_it_signature_path ? Storage::url($userAccess->head_it_signature_path) : null,\\n                        'date' => $userAccess->head_it_approved_at,\\n                        'has_signature' => !empty($userAccess->head_it_signature_path),\\n                        'is_approved' => !empty($userAccess->head_it_approved_at)\\n                    ],\\n                    'ictOfficer' => [\\n                        'name' => $userAccess->ict_officer_name,\\n                        'signature' => $userAccess->ict_officer_signature_path,\\n                        'signature_url' => $userAccess->ict_officer_signature_path ? Storage::url($userAccess->ict_officer_signature_path) : null,\\n                        'date' => $userAccess->ict_officer_implemented_at,\\n                        'comments' => $userAccess->ict_officer_comments,\\n                        'implementation_comments' => $userAccess->implementation_comments,\\n                        'has_signature' => !empty($userAccess->ict_officer_signature_path),\\n                        'is_implemented' => !empty($userAccess->ict_officer_implemented_at)\\n                    ]\\n                ],\\n                \\n                'created_at' => $userAccess->created_at,\\n                'updated_at' => $userAccess->updated_at,\\n                'next_approval_step' => $userAccess->getNextApprovalNeeded(),\\n                'approval_progress' => $userAccess->getApprovalProgress(),\\n                'workflow_stage' => $userAccess->getCurrentWorkflowStage()\\n            ];\\n            \\n            return response()->json([\\n                'success' => true,\\n                'data' => $transformedData\\n            ]);\\n            \\n        } catch (\\\\Exception $e) {\\n            Log::error('Error getting both service form details', [\\n                'error' => $e->getMessage(),\\n                'id' => $id,\\n                'user_id' => $request->user()?->id\\n            ]);\\n            \\n            return response()->json([\\n                'success' => false,\\n                'message' => 'Failed to get form details'\\n            ], 500);\\n        }\\n    }\\n}"},"line_number":109,"absolute_offset":5126,"submatches":[{"match":{"text":"department_id !== $hodDepartment->id) {\\n                        $canView = false;\\n                    }\\n                }\\n            }\\n            \\n            if (!$canView) {\\n                return response()->json([\\n                    'success' => false,\\n                    'message' => 'Access denied.'\\n                ], 403);\\n            }\\n            \\n            // FIXED: Transform data with proper module information\\n            $transformedData = [\\n                'id' => $userAccess->id,\\n                'shared' => [\\n                    'pfNumber' => $userAccess->pf_number,\\n                    'staffName' => $userAccess->staff_name,\\n                    'department' => $userAccess->department?->name ?? '',\\n                    'phone' => $userAccess->phone_number,\\n                ],\\n                'signature_path' => $userAccess->signature_path,\\n                'signature_url' => $userAccess->signature_path ? Storage::url($userAccess->signature_path) : null,\\n                \\n                // FIXED: Proper module data\\n                'wellsoft_modules_selected' => $userAccess->wellsoft_modules_selected ?? [],\\n                'jeeva_modules_selected' => $userAccess->jeeva_modules_selected ?? [],\\n                'wellsoft_modules' => $userAccess->wellsoft_modules ?? [],\\n                'jeeva_modules' => $userAccess->jeeva_modules ?? [],\\n                'module_requested_for' => $userAccess->module_requested_for ?? 'use',\\n                \\n                'internet_purposes' => $userAccess->internet_purposes ?? [],\\n                'access_type' => $userAccess->access_type ?? 'permanent',\\n                'temporary_until' => $userAccess->temporary_until,\\n                'request_type' => $userAccess->request_type ?? [],\\n                'status' => $userAccess->status,\\n                \\n                // FIXED: Complete approval information\\n                'approvals' => [\\n                    'hod' => [\\n                        'name' => $userAccess->hod_name,\\n                        'signature' => $userAccess->hod_signature_path,\\n                        'signature_url' => $userAccess->hod_signature_path ? Storage::url($userAccess->hod_signature_path) : null,\\n                        'date' => $userAccess->hod_approved_at,\\n                        'comments' => $userAccess->hod_comments,\\n                        'approved_by' => $userAccess->hod_approved_by_name,\\n                        'has_signature' => !empty($userAccess->hod_signature_path),\\n                        'is_approved' => !empty($userAccess->hod_approved_at)\\n                    ],\\n                    'divisionalDirector' => [\\n                        'name' => $userAccess->divisional_director_name,\\n                        'signature' => $userAccess->divisional_director_signature_path,\\n                        'signature_url' => $userAccess->divisional_director_signature_path ? Storage::url($userAccess->divisional_director_signature_path) : null,\\n                        'date' => $userAccess->divisional_approved_at,\\n                        'comments' => $userAccess->divisional_director_comments,\\n                        'has_signature' => !empty($userAccess->divisional_director_signature_path),\\n                        'is_approved' => !empty($userAccess->divisional_approved_at)\\n                    ],\\n                    'directorICT' => [\\n                        'name' => $userAccess->ict_director_name,\\n                        'signature' => $userAccess->ict_director_signature_path,\\n                        'signature_url' => $userAccess->ict_director_signature_path ? Storage::url($userAccess->ict_director_signature_path) : null,\\n                        'date' => $userAccess->ict_director_approved_at,\\n                        'comments' => $userAccess->ict_director_comments,\\n                        'has_signature' => !empty($userAccess->ict_director_signature_path),\\n                        'is_approved' => !empty($userAccess->ict_director_approved_at)\\n                    ]\\n                ],\\n                \\n                // Implementation data\\n                'implementation' => [\\n                    'headIT' => [\\n                        'name' => $userAccess->head_it_name,\\n                        'signature' => $userAccess->head_it_signature_path,\\n                        'signature_url' => $userAccess->head_it_signature_path ? Storage::url($userAccess->head_it_signature_path) : null,\\n                        'date' => $userAccess->head_it_approved_at,\\n                        'has_signature' => !empty($userAccess->head_it_signature_path),\\n                        'is_approved' => !empty($userAccess->head_it_approved_at)\\n                    ],\\n                    'ictOfficer' => [\\n                        'name' => $userAccess->ict_officer_name,\\n                        'signature' => $userAccess->ict_officer_signature_path,\\n                        'signature_url' => $userAccess->ict_officer_signature_path ? Storage::url($userAccess->ict_officer_signature_path) : null,\\n                        'date' => $userAccess->ict_officer_implemented_at,\\n                        'comments' => $userAccess->ict_officer_comments,\\n                        'implementation_comments' => $userAccess->implementation_comments,\\n                        'has_signature' => !empty($userAccess->ict_officer_signature_path),\\n                        'is_implemented' => !empty($userAccess->ict_officer_implemented_at)\\n                    ]\\n                ],\\n                \\n                'created_at' => $userAccess->created_at,\\n                'updated_at' => $userAccess->updated_at,\\n                'next_approval_step' => $userAccess->getNextApprovalNeeded(),\\n                'approval_progress' => $userAccess->getApprovalProgress(),\\n                'workflow_stage' => $userAccess->getCurrentWorkflowStage()\\n            ];\\n            \\n            return response()->json([\\n                'success' => true,\\n                'data' => $transformedData\\n            ]);\\n            \\n        } catch (\\\\Exception $e) {\\n            Log::error('Error getting both service form details', [\\n                'error' => $e->getMessage(),\\n                'id' => $id,\\n                'user_id' => $request->user()?->id\\n            ]);\\n            \\n            return response()->json([\\n                'success' => false,\\n                'message' ="},"start":10876,"end":17364}]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\BothServiceFormControllerFixed.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":399900,"human":"0.000400s"},"searches":1,"searches_with_match":1,"bytes_searched":22563,"bytes_printed":39658,"matched_lines":4,"matches":4}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":370,"absolute_offset":13178,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":371,"absolute_offset":13179,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":372,"absolute_offset":13217,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'data' => $departments,\n"},"line_number":373,"absolute_offset":13252,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'message' => 'Departments retrieved successfully.'\n"},"line_number":374,"absolute_offset":13292,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            ]);\n"},"line_number":375,"absolute_offset":13359,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":376,"absolute_offset":13375,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":377,"absolute_offset":13376,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            Log::error('Error retrieving departments: ' . $e->getMessage());\n"},"line_number":378,"absolute_offset":13410,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            \n"},"line_number":379,"absolute_offset":13487,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":380,"absolute_offset":13500,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":381,"absolute_offset":13538,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'message' => 'Failed to retrieve departments.',\n"},"line_number":382,"absolute_offset":13574,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":383,"absolute_offset":13638,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            ], 500);\n"},"line_number":384,"absolute_offset":13730,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        }\n"},"line_number":385,"absolute_offset":13751,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"    }\n"},"line_number":386,"absolute_offset":13761,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":387,"absolute_offset":13767,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"    /**\n"},"line_number":388,"absolute_offset":13768,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"     * Create a new user with roles and department assignment.\n"},"line_number":389,"absolute_offset":13776,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"     */\n"},"line_number":390,"absolute_offset":13839,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"    public function createUser(Request $request): JsonResponse\n"},"line_number":391,"absolute_offset":13847,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"    {\n"},"line_number":392,"absolute_offset":13910,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        // Validate the request\n"},"line_number":393,"absolute_offset":13916,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        $validated = $request->validate([\n"},"line_number":394,"absolute_offset":13948,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'name' => 'required|string|max:255',\n"},"line_number":395,"absolute_offset":13990,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'email' => 'required|email|unique:users,email',\n"},"line_number":396,"absolute_offset":14039,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'password' => 'required|string|min:8',\n"},"line_number":397,"absolute_offset":14099,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'pf_number' => 'nullable|string|max:50|unique:users,pf_number',\n"},"line_number":398,"absolute_offset":14150,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'phone' => 'nullable|string|max:20',\n"},"line_number":399,"absolute_offset":14226,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'department_id' => 'nullable|exists:departments,id',\n"},"line_number":400,"absolute_offset":14275,"submatches":[{"match":{"text":"department_id' ="},"start":13,"end":29}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'role_ids' => 'nullable|array',\n"},"line_number":401,"absolute_offset":14340,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            'role_ids.*' => 'exists:roles,id',\n"},"line_number":402,"absolute_offset":14384,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        ]);\n"},"line_number":403,"absolute_offset":14431,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":404,"absolute_offset":14443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        DB::beginTransaction();\n"},"line_number":405,"absolute_offset":14444,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        \n"},"line_number":406,"absolute_offset":14476,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"        try {\n"},"line_number":407,"absolute_offset":14485,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            $currentUser = $request->user();\n"},"line_number":408,"absolute_offset":14499,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":409,"absolute_offset":14544,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            // Create the user\n"},"line_number":410,"absolute_offset":14545,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            $user = User::create([\n"},"line_number":411,"absolute_offset":14576,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'name' => $validated['name'],\n"},"line_number":412,"absolute_offset":14611,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'email' => $validated['email'],\n"},"line_number":413,"absolute_offset":14657,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'password' => Hash::make($validated['password']),\n"},"line_number":414,"absolute_offset":14705,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'pf_number' => $validated['pf_number'] ?? null,\n"},"line_number":415,"absolute_offset":14771,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'phone' => $validated['phone'] ?? null,\n"},"line_number":416,"absolute_offset":14835,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'is_active' => true,\n"},"line_number":417,"absolute_offset":14891,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            ]);\n"},"line_number":418,"absolute_offset":14928,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":419,"absolute_offset":14944,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            // Assign roles if provided\n"},"line_number":420,"absolute_offset":14945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            if (!empty($validated['role_ids'])) {\n"},"line_number":421,"absolute_offset":14985,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                $roleData = [];\n"},"line_number":422,"absolute_offset":15035,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                foreach ($validated['role_ids'] as $roleId) {\n"},"line_number":423,"absolute_offset":15067,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                    $roleData[$roleId] = [\n"},"line_number":424,"absolute_offset":15129,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'assigned_at' => now(),\n"},"line_number":425,"absolute_offset":15172,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'assigned_by' => $currentUser->id,\n"},"line_number":426,"absolute_offset":15220,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'created_at' => now(),\n"},"line_number":427,"absolute_offset":15279,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'updated_at' => now(),\n"},"line_number":428,"absolute_offset":15326,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                    ];\n"},"line_number":429,"absolute_offset":15373,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                }\n"},"line_number":430,"absolute_offset":15396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                \n"},"line_number":431,"absolute_offset":15414,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                $user->roles()->attach($roleData);\n"},"line_number":432,"absolute_offset":15431,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                \n"},"line_number":433,"absolute_offset":15482,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                // Log role assignments\n"},"line_number":434,"absolute_offset":15499,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                foreach ($validated['role_ids'] as $roleId) {\n"},"line_number":435,"absolute_offset":15539,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                    RoleChangeLog::create([\n"},"line_number":436,"absolute_offset":15601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'user_id' => $user->id,\n"},"line_number":437,"absolute_offset":15645,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'role_id' => $roleId,\n"},"line_number":438,"absolute_offset":15693,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'action' => 'assigned',\n"},"line_number":439,"absolute_offset":15739,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'changed_by' => $currentUser->id,\n"},"line_number":440,"absolute_offset":15787,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'changed_at' => now(),\n"},"line_number":441,"absolute_offset":15845,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'metadata' => [\n"},"line_number":442,"absolute_offset":15892,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                            'user_email' => $user->email,\n"},"line_number":443,"absolute_offset":15932,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                            'changed_by_email' => $currentUser->email,\n"},"line_number":444,"absolute_offset":15990,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                            'context' => 'user_creation'\n"},"line_number":445,"absolute_offset":16061,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        ]\n"},"line_number":446,"absolute_offset":16118,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                    ]);\n"},"line_number":447,"absolute_offset":16144,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                }\n"},"line_number":448,"absolute_offset":16168,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            }\n"},"line_number":449,"absolute_offset":16186,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":450,"absolute_offset":16200,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            // Log user creation\n"},"line_number":451,"absolute_offset":16201,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            Log::info('New user created', [\n"},"line_number":452,"absolute_offset":16234,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'user_id' => $user->id,\n"},"line_number":453,"absolute_offset":16278,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'user_email' => $user->email,\n"},"line_number":454,"absolute_offset":16318,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'user_name' => $user->name,\n"},"line_number":455,"absolute_offset":16364,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'department_id' => $validated['department_id'] ?? null,\n"},"line_number":456,"absolute_offset":16408,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'roles_assigned' => $validated['role_ids'] ?? [],\n"},"line_number":457,"absolute_offset":16480,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'created_by' => $currentUser->id\n"},"line_number":458,"absolute_offset":16546,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            ]);\n"},"line_number":459,"absolute_offset":16595,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":460,"absolute_offset":16611,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            DB::commit();\n"},"line_number":461,"absolute_offset":16612,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":462,"absolute_offset":16638,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            // Load relationships for response\n"},"line_number":463,"absolute_offset":16639,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            $user->load(['roles', 'departmentsAsHOD']);\n"},"line_number":464,"absolute_offset":16686,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":465,"absolute_offset":16742,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            // Get department info if assigned\n"},"line_number":466,"absolute_offset":16743,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            $department = null;\n"},"line_number":467,"absolute_offset":16790,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            if ($validated['department_id']) {\n"},"line_number":468,"absolute_offset":16822,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                $department = Department::find($validated['department_id']);\n"},"line_number":469,"absolute_offset":16869,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            }\n"},"line_number":470,"absolute_offset":16946,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"\n"},"line_number":471,"absolute_offset":16960,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":472,"absolute_offset":16961,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":473,"absolute_offset":16999,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                'data' => [\n"},"line_number":474,"absolute_offset":17034,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                    'user' => [\n"},"line_number":475,"absolute_offset":17062,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'id' => $user->id,\n"},"line_number":476,"absolute_offset":17094,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'name' => $user->name,\n"},"line_number":477,"absolute_offset":17137,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'email' => $user->email,\n"},"line_number":478,"absolute_offset":17184,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'pf_number' => $user->pf_number,\n"},"line_number":479,"absolute_offset":17233,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'phone' => $user->phone,\n"},"line_number":480,"absolute_offset":17290,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'is_active' => $user->is_active,\n"},"line_number":481,"absolute_offset":17339,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'created_at' => $user->created_at,\n"},"line_number":482,"absolute_offset":17396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                        'roles' => $user->roles->map(function ($role) {\n"},"line_number":483,"absolute_offset":17455,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                            return [\n"},"line_number":484,"absolute_offset":17527,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                                'id' => $role->id,\n"},"line_number":485,"absolute_offset":17564,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"lines":{"text":"                                'name' => $role->name,\n"},"line_number":486,"absolute_offset":17615,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserRoleController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":121400,"human":"0.000121s"},"searches":1,"searches_with_match":1,"bytes_searched":18652,"bytes_printed":26942,"matched_lines":2,"matches":2}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'selectedWellsoft_count' => count($selectedWellsoft),\n"},"line_number":146,"absolute_offset":5972,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'selectedJeeva_count' => count($selectedJeeva),\n"},"line_number":147,"absolute_offset":6042,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoftRequestType' => $request->input('wellsoftRequestType', 'use')\n"},"line_number":148,"absolute_offset":6106,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":149,"absolute_offset":6193,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":150,"absolute_offset":6209,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Note: Module selection is done by HOD during approval process at /both-service-form/:id\n"},"line_number":151,"absolute_offset":6222,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // User submission only includes service selections (Jeeva, Wellsoft, Internet Access)\n"},"line_number":152,"absolute_offset":6325,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Modules will be populated by HOD during approval workflow\n"},"line_number":153,"absolute_offset":6424,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":154,"absolute_offset":6497,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            Log::info('User submitted service request - modules will be selected by HOD during approval', [\n"},"line_number":155,"absolute_offset":6510,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'user_id' => $user->id,\n"},"line_number":156,"absolute_offset":6618,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'selected_services' => $selectedServices,\n"},"line_number":157,"absolute_offset":6658,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules_from_request' => $selectedWellsoft,\n"},"line_number":158,"absolute_offset":6716,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules_from_request' => $selectedJeeva,\n"},"line_number":159,"absolute_offset":6786,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'note' => 'Empty module arrays are expected - HOD selects modules during approval'\n"},"line_number":160,"absolute_offset":6850,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":161,"absolute_offset":6949,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":162,"absolute_offset":6965,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            Log::info('Creating combined user access request', [\n"},"line_number":163,"absolute_offset":6978,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'selected_services' => $selectedServices,\n"},"line_number":164,"absolute_offset":7043,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'purposes' => $purposes,\n"},"line_number":165,"absolute_offset":7101,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules_count' => count($selectedWellsoft),\n"},"line_number":166,"absolute_offset":7142,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules_count' => count($selectedJeeva)\n"},"line_number":167,"absolute_offset":7212,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":168,"absolute_offset":7275,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":169,"absolute_offset":7291,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Create the combined access request - store multiple services in one row\n"},"line_number":170,"absolute_offset":7304,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $userAccess = UserAccess::create([\n"},"line_number":171,"absolute_offset":7391,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'user_id' => $user->id,\n"},"line_number":172,"absolute_offset":7438,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'pf_number' => $validatedData['pf_number'],\n"},"line_number":173,"absolute_offset":7478,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'staff_name' => $validatedData['staff_name'],\n"},"line_number":174,"absolute_offset":7538,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'phone_number' => $validatedData['phone_number'],\n"},"line_number":175,"absolute_offset":7600,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'department_id' => $validatedData['department_id'],\n"},"line_number":176,"absolute_offset":7666,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'signature_path' => $signaturePath,\n"},"line_number":177,"absolute_offset":7734,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'purpose' => $purposes,\n"},"line_number":178,"absolute_offset":7786,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_type' => $selectedServices, // Array stored as JSON\n"},"line_number":179,"absolute_offset":7826,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'status' => 'pending',\n"},"line_number":180,"absolute_offset":7903,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":181,"absolute_offset":7942,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // Module selections will be populated by HOD during approval process\n"},"line_number":182,"absolute_offset":7959,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules' => [],\n"},"line_number":183,"absolute_offset":8045,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules_selected' => [],\n"},"line_number":184,"absolute_offset":8087,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules' => [],\n"},"line_number":185,"absolute_offset":8138,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules_selected' => [],\n"},"line_number":186,"absolute_offset":8177,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'module_requested_for' => $request->input('wellsoftRequestType', 'use'),\n"},"line_number":187,"absolute_offset":8225,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'internet_purposes' => array_filter($request->input('internetPurposes', []), function($purpose) {\n"},"line_number":188,"absolute_offset":8314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    return !empty(trim($purpose));\n"},"line_number":189,"absolute_offset":8428,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                }),\n"},"line_number":190,"absolute_offset":8479,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":191,"absolute_offset":8499,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // \\u2705 ADD ACCESS TYPE AND TEMPORARY DATE\n"},"line_number":192,"absolute_offset":8516,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'access_type' => $request->input('accessType', 'permanent'),\n"},"line_number":193,"absolute_offset":8577,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'temporary_until' => $request->input('temporaryUntil'),\n"},"line_number":194,"absolute_offset":8654,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":195,"absolute_offset":8726,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // \\u2705 ADD APPROVAL DATA\n"},"line_number":196,"absolute_offset":8743,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'hod_name' => $request->input('hodName'),\n"},"line_number":197,"absolute_offset":8787,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'hod_signature_path' => $this->handleSignatureUpload($request, 'hodSignature', $validatedData['pf_number'], 'hod'),\n"},"line_number":198,"absolute_offset":8845,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'hod_approved_at' => $request->input('hodDate') ? $request->input('hodDate') : null,\n"},"line_number":199,"absolute_offset":8977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'hod_comments' => $request->input('hodComments'),\n"},"line_number":200,"absolute_offset":9078,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":201,"absolute_offset":9144,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'divisional_director_name' => $request->input('divisionalDirectorName'),\n"},"line_number":202,"absolute_offset":9161,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'divisional_director_signature_path' => $this->handleSignatureUpload($request, 'divisionalDirectorSignature', $validatedData['pf_number'], 'divisional_director'),\n"},"line_number":203,"absolute_offset":9250,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'divisional_approved_at' => $request->input('divisionalDirectorDate') ? $request->input('divisionalDirectorDate') : null,\n"},"line_number":204,"absolute_offset":9429,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'divisional_director_comments' => $request->input('divisionalDirectorComments'),\n"},"line_number":205,"absolute_offset":9567,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":206,"absolute_offset":9664,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Check if user owns this request\n"},"line_number":342,"absolute_offset":16116,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            if ($userAccess->user_id !== Auth::id()) {\n"},"line_number":343,"absolute_offset":16163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":344,"absolute_offset":16218,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":345,"absolute_offset":16260,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'message' => 'Unauthorized access to this request.'\n"},"line_number":346,"absolute_offset":16300,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                ], 403);\n"},"line_number":347,"absolute_offset":16372,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            }\n"},"line_number":348,"absolute_offset":16397,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":349,"absolute_offset":16411,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Check if request can be updated (only pending or rejected requests)\n"},"line_number":350,"absolute_offset":16412,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            if (!$userAccess->canBeUpdated()) {\n"},"line_number":351,"absolute_offset":16495,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":352,"absolute_offset":16543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":353,"absolute_offset":16585,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'message' => 'Only pending or rejected requests can be updated.'\n"},"line_number":354,"absolute_offset":16625,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                ], 422);\n"},"line_number":355,"absolute_offset":16710,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            }\n"},"line_number":356,"absolute_offset":16735,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":357,"absolute_offset":16749,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Log the incoming request for debugging\n"},"line_number":358,"absolute_offset":16750,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            Log::info('Updating user access request - Full debug', [\n"},"line_number":359,"absolute_offset":16804,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_id' => $userAccess->id,\n"},"line_number":360,"absolute_offset":16873,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_method' => $request->method(),\n"},"line_number":361,"absolute_offset":16922,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'has_method_override' => $request->has('_method'),\n"},"line_number":362,"absolute_offset":16978,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'method_override_value' => $request->input('_method'),\n"},"line_number":363,"absolute_offset":17045,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'all_input' => $request->except(['signature']),\n"},"line_number":364,"absolute_offset":17116,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'all_keys' => array_keys($request->all()),\n"},"line_number":365,"absolute_offset":17180,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'has_signature_file' => $request->hasFile('signature'),\n"},"line_number":366,"absolute_offset":17239,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'content_type' => $request->header('content-type'),\n"},"line_number":367,"absolute_offset":17311,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_data_debug' => [\n"},"line_number":368,"absolute_offset":17379,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'pf_number' => $request->input('pf_number'),\n"},"line_number":369,"absolute_offset":17421,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'staff_name' => $request->input('staff_name'),\n"},"line_number":370,"absolute_offset":17486,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'phone_number' => $request->input('phone_number'),\n"},"line_number":371,"absolute_offset":17553,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'department_id' => $request->input('department_id'),\n"},"line_number":372,"absolute_offset":17624,"submatches":[{"match":{"text":"department_id' ="},"start":21,"end":37}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'request_type' => $request->input('request_type'),\n"},"line_number":373,"absolute_offset":17697,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    'internetPurposes' => $request->input('internetPurposes')\n"},"line_number":374,"absolute_offset":17768,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                ]\n"},"line_number":375,"absolute_offset":17846,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":376,"absolute_offset":17864,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":377,"absolute_offset":17880,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $validatedData = $request->validated();\n"},"line_number":378,"absolute_offset":17881,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":379,"absolute_offset":17933,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Handle signature update if new file uploaded\n"},"line_number":380,"absolute_offset":17946,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $signaturePath = $userAccess->signature_path; // Keep existing signature by default\n"},"line_number":381,"absolute_offset":18006,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":382,"absolute_offset":18102,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            if ($request->hasFile('signature')) {\n"},"line_number":383,"absolute_offset":18115,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // Delete old signature if it exists and is not shared\n"},"line_number":384,"absolute_offset":18165,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                if ($userAccess->signature_path) {\n"},"line_number":385,"absolute_offset":18236,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    $this->signatureService->deleteSignature($userAccess->signature_path);\n"},"line_number":386,"absolute_offset":18287,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                }\n"},"line_number":387,"absolute_offset":18378,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":388,"absolute_offset":18396,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // Store new signature using the same method as create\n"},"line_number":389,"absolute_offset":18413,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                $signaturePath = $this->storeSignature(\n"},"line_number":390,"absolute_offset":18484,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    $request->file('signature'),\n"},"line_number":391,"absolute_offset":18540,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    $validatedData['pf_number']\n"},"line_number":392,"absolute_offset":18589,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                );\n"},"line_number":393,"absolute_offset":18637,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            }\n"},"line_number":394,"absolute_offset":18656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":395,"absolute_offset":18670,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Get selected services from validated data\n"},"line_number":396,"absolute_offset":18671,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $selectedServices = $validatedData['request_type'];\n"},"line_number":397,"absolute_offset":18728,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":398,"absolute_offset":18792,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Process module selections with comprehensive fallback strategies (same as store method)\n"},"line_number":399,"absolute_offset":18805,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $selectedWellsoft = $this->processModuleArray($request, 'selectedWellsoft');\n"},"line_number":400,"absolute_offset":18908,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $selectedJeeva = $this->processModuleArray($request, 'selectedJeeva');\n"},"line_number":401,"absolute_offset":18997,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":402,"absolute_offset":19080,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Process internet purposes if internet access is selected\n"},"line_number":403,"absolute_offset":19093,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $purposes = null;\n"},"line_number":404,"absolute_offset":19165,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            if (in_array('internet_access_request', $selectedServices) && isset($validatedData['internetPurposes'])) {\n"},"line_number":405,"absolute_offset":19195,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                $purposes = array_filter($validatedData['internetPurposes'], function($purpose) {\n"},"line_number":406,"absolute_offset":19314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                    return !empty(trim($purpose));\n"},"line_number":407,"absolute_offset":19412,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                });\n"},"line_number":408,"absolute_offset":19463,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                $purposes = array_values($purposes); // Re-index array\n"},"line_number":409,"absolute_offset":19483,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            }\n"},"line_number":410,"absolute_offset":19554,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":411,"absolute_offset":19568,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            Log::info('Updating combined access request', [\n"},"line_number":412,"absolute_offset":19581,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_id' => $userAccess->id,\n"},"line_number":413,"absolute_offset":19641,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'selected_services' => $selectedServices,\n"},"line_number":414,"absolute_offset":19690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'purposes' => $purposes,\n"},"line_number":415,"absolute_offset":19748,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'signature_updated' => $request->hasFile('signature'),\n"},"line_number":416,"absolute_offset":19789,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules_count' => count($selectedWellsoft),\n"},"line_number":417,"absolute_offset":19860,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules_count' => count($selectedJeeva)\n"},"line_number":418,"absolute_offset":19930,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":419,"absolute_offset":19993,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":420,"absolute_offset":20009,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Update the request with all fields including services and modules\n"},"line_number":421,"absolute_offset":20010,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $userAccess->update([\n"},"line_number":422,"absolute_offset":20091,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'pf_number' => $validatedData['pf_number'],\n"},"line_number":423,"absolute_offset":20125,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'staff_name' => $validatedData['staff_name'],\n"},"line_number":424,"absolute_offset":20185,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'phone_number' => $validatedData['phone_number'],\n"},"line_number":425,"absolute_offset":20247,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'department_id' => $validatedData['department_id'],\n"},"line_number":426,"absolute_offset":20313,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'signature_path' => $signaturePath,\n"},"line_number":427,"absolute_offset":20381,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_type' => $selectedServices, // Update services\n"},"line_number":428,"absolute_offset":20433,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'purpose' => $purposes, // Update internet purposes\n"},"line_number":429,"absolute_offset":20505,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'status' => 'pending', // Reset status to pending for resubmission\n"},"line_number":430,"absolute_offset":20573,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                \n"},"line_number":431,"absolute_offset":20656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                // Update module selections\n"},"line_number":432,"absolute_offset":20673,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules' => $selectedWellsoft,\n"},"line_number":433,"absolute_offset":20717,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'wellsoft_modules_selected' => $selectedWellsoft,\n"},"line_number":434,"absolute_offset":20774,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules' => $selectedJeeva,\n"},"line_number":435,"absolute_offset":20840,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'jeeva_modules_selected' => $selectedJeeva,\n"},"line_number":436,"absolute_offset":20891,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'module_requested_for' => $request->input('wellsoftRequestType', 'use'),\n"},"line_number":437,"absolute_offset":20951,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            ]);\n"},"line_number":438,"absolute_offset":21040,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":439,"absolute_offset":21056,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $userAccess->load(['user', 'department']);\n"},"line_number":440,"absolute_offset":21057,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            \n"},"line_number":441,"absolute_offset":21112,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Add signature info\n"},"line_number":442,"absolute_offset":21125,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $userAccess->signature_url = $this->signatureService->getSignatureUrl($userAccess->signature_path);\n"},"line_number":443,"absolute_offset":21159,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            $userAccess->signature_info = $this->signatureService->getSignatureInfo($userAccess->signature_path);\n"},"line_number":444,"absolute_offset":21271,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":445,"absolute_offset":21385,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            // Forward to appropriate queues for each service type (reprocess workflow)\n"},"line_number":446,"absolute_offset":21386,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            foreach ($selectedServices as $serviceType) {\n"},"line_number":447,"absolute_offset":21474,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                $this->forwardToHodQueue($userAccess, $serviceType);\n"},"line_number":448,"absolute_offset":21532,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            }\n"},"line_number":449,"absolute_offset":21601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"\n"},"line_number":450,"absolute_offset":21615,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"            Log::info(\"User access request updated and resubmitted\", [\n"},"line_number":451,"absolute_offset":21616,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'user_id' => Auth::id(),\n"},"line_number":452,"absolute_offset":21687,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_id' => $userAccess->id,\n"},"line_number":453,"absolute_offset":21728,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'pf_number' => $validatedData['pf_number'],\n"},"line_number":454,"absolute_offset":21777,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'request_types' => $selectedServices,\n"},"line_number":455,"absolute_offset":21837,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"lines":{"text":"                'service_count' => count($selectedServices)\n"},"line_number":456,"absolute_offset":21891,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserAccessController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":237100,"human":"0.000237s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":43555,"matched_lines":3,"matches":3}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    /**\n"},"line_number":14,"absolute_offset":284,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * Get current user's profile information for form auto-population\n"},"line_number":15,"absolute_offset":292,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * \n"},"line_number":16,"absolute_offset":363,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * @param Request $request\n"},"line_number":17,"absolute_offset":371,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * @return \\Illuminate\\Http\\JsonResponse\n"},"line_number":18,"absolute_offset":402,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     */\n"},"line_number":19,"absolute_offset":447,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    public function getCurrentUserProfile(Request $request)\n"},"line_number":20,"absolute_offset":455,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    {\n"},"line_number":21,"absolute_offset":515,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"        try {\n"},"line_number":22,"absolute_offset":521,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user = Auth::user();\n"},"line_number":23,"absolute_offset":535,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            \n"},"line_number":24,"absolute_offset":569,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if (!$user) {\n"},"line_number":25,"absolute_offset":582,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":26,"absolute_offset":608,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":27,"absolute_offset":650,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'message' => 'User not authenticated'\n"},"line_number":28,"absolute_offset":690,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ], 401);\n"},"line_number":29,"absolute_offset":748,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":30,"absolute_offset":773,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":31,"absolute_offset":787,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            // Load department relationship\n"},"line_number":32,"absolute_offset":788,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user->load('department');\n"},"line_number":33,"absolute_offset":832,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":34,"absolute_offset":871,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            // Prepare profile data for form auto-population\n"},"line_number":35,"absolute_offset":872,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $profileData = [\n"},"line_number":36,"absolute_offset":933,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'id' => $user->id,\n"},"line_number":37,"absolute_offset":962,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'pf_number' => $user->pf_number,\n"},"line_number":38,"absolute_offset":997,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'staff_name' => $user->name, // Use name as staff_name since staff_name column doesn't exist\n"},"line_number":39,"absolute_offset":1046,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'full_name' => $user->name,\n"},"line_number":40,"absolute_offset":1155,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'phone' => $user->phone,\n"},"line_number":41,"absolute_offset":1199,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'phone_number' => $user->phone, // Alias for compatibility\n"},"line_number":42,"absolute_offset":1240,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'email' => $user->email,\n"},"line_number":43,"absolute_offset":1315,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'department_id' => $user->department_id,\n"},"line_number":44,"absolute_offset":1356,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'department' => $user->department ? [\n"},"line_number":45,"absolute_offset":1413,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'id' => $user->department->id,\n"},"line_number":46,"absolute_offset":1467,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'name' => $user->department->name,\n"},"line_number":47,"absolute_offset":1518,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'code' => $user->department->code,\n"},"line_number":48,"absolute_offset":1573,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'full_name' => $user->department->getFullNameAttribute(),\n"},"line_number":49,"absolute_offset":1628,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'display_name' => $user->department->getFullNameAttribute()\n"},"line_number":50,"absolute_offset":1706,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ] : null,\n"},"line_number":51,"absolute_offset":1786,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'is_active' => $user->is_active ?? true,\n"},"line_number":52,"absolute_offset":1812,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'primary_role' => $user->getPrimaryRoleName(),\n"},"line_number":53,"absolute_offset":1869,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'roles' => $user->roles->pluck('name')->toArray(),\n"},"line_number":54,"absolute_offset":1932,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ];\n"},"line_number":55,"absolute_offset":1999,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":56,"absolute_offset":2014,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            Log::info('User profile retrieved for auto-population', [\n"},"line_number":57,"absolute_offset":2015,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'user_id' => $user->id,\n"},"line_number":58,"absolute_offset":2085,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'pf_number' => $profileData['pf_number'],\n"},"line_number":59,"absolute_offset":2125,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'has_staff_name' => !empty($profileData['staff_name']),\n"},"line_number":60,"absolute_offset":2183,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'has_phone' => !empty($profileData['phone']),\n"},"line_number":61,"absolute_offset":2255,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'has_department' => !empty($profileData['department'])\n"},"line_number":62,"absolute_offset":2317,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ]);\n"},"line_number":63,"absolute_offset":2388,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":64,"absolute_offset":2404,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":65,"absolute_offset":2405,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":66,"absolute_offset":2443,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'data' => $profileData,\n"},"line_number":67,"absolute_offset":2478,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'message' => 'User profile retrieved successfully'\n"},"line_number":68,"absolute_offset":2518,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ]);\n"},"line_number":69,"absolute_offset":2585,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":70,"absolute_offset":2601,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":71,"absolute_offset":2602,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            Log::error('Error retrieving user profile: ' . $e->getMessage(), [\n"},"line_number":72,"absolute_offset":2636,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'user_id' => Auth::id(),\n"},"line_number":73,"absolute_offset":2715,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'trace' => $e->getTraceAsString()\n"},"line_number":74,"absolute_offset":2756,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            // Check if current user has permission to look up other users\n"},"line_number":106,"absolute_offset":3684,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if (!$currentUser->hasAnyRole(['admin', 'head_of_department', 'divisional_director', 'ict_director', 'ict_officer'])) {\n"},"line_number":107,"absolute_offset":3759,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":108,"absolute_offset":3891,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":109,"absolute_offset":3933,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'message' => 'Insufficient permissions to look up user by PF Number'\n"},"line_number":110,"absolute_offset":3973,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ], 403);\n"},"line_number":111,"absolute_offset":4062,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":112,"absolute_offset":4087,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":113,"absolute_offset":4101,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user = User::where('pf_number', $request->pf_number)\n"},"line_number":114,"absolute_offset":4102,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ->where('is_active', true)\n"},"line_number":115,"absolute_offset":4168,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ->with('department')\n"},"line_number":116,"absolute_offset":4211,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ->first();\n"},"line_number":117,"absolute_offset":4248,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":118,"absolute_offset":4275,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if (!$user) {\n"},"line_number":119,"absolute_offset":4276,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":120,"absolute_offset":4302,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":121,"absolute_offset":4344,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'message' => 'No active user found with the provided PF Number',\n"},"line_number":122,"absolute_offset":4384,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'data' => null\n"},"line_number":123,"absolute_offset":4469,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ], 404);\n"},"line_number":124,"absolute_offset":4504,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":125,"absolute_offset":4529,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":126,"absolute_offset":4543,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            // Prepare user data\n"},"line_number":127,"absolute_offset":4544,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $userData = [\n"},"line_number":128,"absolute_offset":4577,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'id' => $user->id,\n"},"line_number":129,"absolute_offset":4603,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'pf_number' => $user->pf_number,\n"},"line_number":130,"absolute_offset":4638,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'staff_name' => $user->name,\n"},"line_number":131,"absolute_offset":4687,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'full_name' => $user->name,\n"},"line_number":132,"absolute_offset":4732,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'phone' => $user->phone,\n"},"line_number":133,"absolute_offset":4776,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'phone_number' => $user->phone,\n"},"line_number":134,"absolute_offset":4817,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'email' => $user->email,\n"},"line_number":135,"absolute_offset":4865,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'department_id' => $user->department_id,\n"},"line_number":136,"absolute_offset":4906,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'department' => $user->department ? [\n"},"line_number":137,"absolute_offset":4963,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'id' => $user->department->id,\n"},"line_number":138,"absolute_offset":5017,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'name' => $user->department->name,\n"},"line_number":139,"absolute_offset":5068,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'code' => $user->department->code,\n"},"line_number":140,"absolute_offset":5123,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'full_name' => $user->department->getFullNameAttribute(),\n"},"line_number":141,"absolute_offset":5178,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'display_name' => $user->department->getFullNameAttribute()\n"},"line_number":142,"absolute_offset":5256,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ] : null,\n"},"line_number":143,"absolute_offset":5336,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'primary_role' => $user->getPrimaryRoleName(),\n"},"line_number":144,"absolute_offset":5362,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'is_active' => $user->is_active\n"},"line_number":145,"absolute_offset":5425,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ];\n"},"line_number":146,"absolute_offset":5473,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":147,"absolute_offset":5488,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            Log::info('User looked up by PF Number', [\n"},"line_number":148,"absolute_offset":5489,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'looked_up_user_id' => $user->id,\n"},"line_number":149,"absolute_offset":5544,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'looked_up_by' => $currentUser->id,\n"},"line_number":150,"absolute_offset":5594,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'pf_number' => $request->pf_number\n"},"line_number":151,"absolute_offset":5646,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ]);\n"},"line_number":152,"absolute_offset":5697,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":153,"absolute_offset":5713,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":154,"absolute_offset":5714,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'success' => true,\n"},"line_number":155,"absolute_offset":5752,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'data' => $userData,\n"},"line_number":156,"absolute_offset":5787,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'message' => 'User found and retrieved successfully'\n"},"line_number":157,"absolute_offset":5824,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ]);\n"},"line_number":158,"absolute_offset":5893,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":159,"absolute_offset":5909,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"        } catch (\\Illuminate\\Validation\\ValidationException $e) {\n"},"line_number":160,"absolute_offset":5910,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":161,"absolute_offset":5976,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":162,"absolute_offset":6014,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'message' => 'Invalid input data',\n"},"line_number":163,"absolute_offset":6050,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'errors' => $e->errors()\n"},"line_number":164,"absolute_offset":6101,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ], 422);\n"},"line_number":165,"absolute_offset":6142,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":166,"absolute_offset":6163,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            Log::error('Error retrieving departments: ' . $e->getMessage());\n"},"line_number":254,"absolute_offset":9162,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":255,"absolute_offset":9239,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            return response()->json([\n"},"line_number":256,"absolute_offset":9240,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'success' => false,\n"},"line_number":257,"absolute_offset":9278,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'message' => 'Failed to retrieve departments',\n"},"line_number":258,"absolute_offset":9314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'error' => config('app.debug') ? $e->getMessage() : 'Internal server error'\n"},"line_number":259,"absolute_offset":9377,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ], 500);\n"},"line_number":260,"absolute_offset":9469,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"        }\n"},"line_number":261,"absolute_offset":9490,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    }\n"},"line_number":262,"absolute_offset":9500,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":263,"absolute_offset":9506,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    /**\n"},"line_number":264,"absolute_offset":9507,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * Update current user's profile information\n"},"line_number":265,"absolute_offset":9515,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * \n"},"line_number":266,"absolute_offset":9564,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * @param Request $request\n"},"line_number":267,"absolute_offset":9572,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     * @return \\Illuminate\\Http\\JsonResponse\n"},"line_number":268,"absolute_offset":9603,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"     */\n"},"line_number":269,"absolute_offset":9648,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    public function updateCurrentUserProfile(Request $request)\n"},"line_number":270,"absolute_offset":9656,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"    {\n"},"line_number":271,"absolute_offset":9719,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"        try {\n"},"line_number":272,"absolute_offset":9725,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user = Auth::user();\n"},"line_number":273,"absolute_offset":9739,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            \n"},"line_number":274,"absolute_offset":9773,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if (!$user) {\n"},"line_number":275,"absolute_offset":9786,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                return response()->json([\n"},"line_number":276,"absolute_offset":9812,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'success' => false,\n"},"line_number":277,"absolute_offset":9854,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'message' => 'User not authenticated'\n"},"line_number":278,"absolute_offset":9894,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ], 401);\n"},"line_number":279,"absolute_offset":9952,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":280,"absolute_offset":9977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":281,"absolute_offset":9991,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $request->validate([\n"},"line_number":282,"absolute_offset":9992,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'phone' => 'sometimes|string|max:20',\n"},"line_number":283,"absolute_offset":10025,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'department_id' => 'sometimes|integer|exists:departments,id'\n"},"line_number":284,"absolute_offset":10079,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            ]);\n"},"line_number":285,"absolute_offset":10156,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":286,"absolute_offset":10172,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $updateData = [];\n"},"line_number":287,"absolute_offset":10173,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            \n"},"line_number":288,"absolute_offset":10203,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if ($request->has('phone')) {\n"},"line_number":289,"absolute_offset":10216,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                $updateData['phone'] = $request->phone;\n"},"line_number":290,"absolute_offset":10258,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":291,"absolute_offset":10314,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            \n"},"line_number":292,"absolute_offset":10328,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if ($request->has('department_id')) {\n"},"line_number":293,"absolute_offset":10341,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                $updateData['department_id'] = $request->department_id;\n"},"line_number":294,"absolute_offset":10391,"submatches":[{"match":{"text":"department_id'] ="},"start":29,"end":46}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":295,"absolute_offset":10463,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":296,"absolute_offset":10477,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            if (!empty($updateData)) {\n"},"line_number":297,"absolute_offset":10478,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                $user->update($updateData);\n"},"line_number":298,"absolute_offset":10517,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                \n"},"line_number":299,"absolute_offset":10561,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                Log::info('User profile updated', [\n"},"line_number":300,"absolute_offset":10578,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'user_id' => $user->id,\n"},"line_number":301,"absolute_offset":10630,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                    'updated_fields' => array_keys($updateData)\n"},"line_number":302,"absolute_offset":10674,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                ]);\n"},"line_number":303,"absolute_offset":10738,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            }\n"},"line_number":304,"absolute_offset":10758,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":305,"absolute_offset":10772,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            // Return updated profile\n"},"line_number":306,"absolute_offset":10773,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user->refresh();\n"},"line_number":307,"absolute_offset":10811,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $user->load('department');\n"},"line_number":308,"absolute_offset":10841,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"\n"},"line_number":309,"absolute_offset":10880,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"            $profileData = [\n"},"line_number":310,"absolute_offset":10881,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'id' => $user->id,\n"},"line_number":311,"absolute_offset":10910,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'pf_number' => $user->pf_number,\n"},"line_number":312,"absolute_offset":10945,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'staff_name' => $user->name,\n"},"line_number":313,"absolute_offset":10994,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"lines":{"text":"                'full_name' => $user->name,\n"},"line_number":314,"absolute_offset":11039,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\UserProfileController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":203500,"human":"0.000204s"},"searches":1,"searches_with_match":1,"bytes_searched":0,"bytes_printed":42348,"matched_lines":4,"matches":4}}}
{"type":"begin","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"}}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":307,"absolute_offset":10441,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        } catch (\\Exception $e) {\n"},"line_number":308,"absolute_offset":10442,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            return [\n"},"line_number":309,"absolute_offset":10476,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'status' => 'error',\n"},"line_number":310,"absolute_offset":10497,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'error' => $e->getMessage()\n"},"line_number":311,"absolute_offset":10534,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            ];\n"},"line_number":312,"absolute_offset":10578,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        }\n"},"line_number":313,"absolute_offset":10593,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    }\n"},"line_number":314,"absolute_offset":10603,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":315,"absolute_offset":10609,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    /**\n"},"line_number":316,"absolute_offset":10610,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"     * Create test users\n"},"line_number":317,"absolute_offset":10618,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"     */\n"},"line_number":318,"absolute_offset":10643,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    private function createTestUsers(): array\n"},"line_number":319,"absolute_offset":10651,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    {\n"},"line_number":320,"absolute_offset":10697,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $testUsers = [];\n"},"line_number":321,"absolute_offset":10703,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        \n"},"line_number":322,"absolute_offset":10728,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        // Get the staff role\n"},"line_number":323,"absolute_offset":10737,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $staffRole = Role::where('name', 'staff')->first();\n"},"line_number":324,"absolute_offset":10767,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $ictRole = Role::where('name', 'ict_officer')->first();\n"},"line_number":325,"absolute_offset":10827,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        \n"},"line_number":326,"absolute_offset":10891,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        // Get a test department\n"},"line_number":327,"absolute_offset":10900,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $department = Department::first();\n"},"line_number":328,"absolute_offset":10933,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":329,"absolute_offset":10976,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        for ($i = 1; $i <= 3; $i++) {\n"},"line_number":330,"absolute_offset":10977,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            $user = User::create([\n"},"line_number":331,"absolute_offset":11015,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'name' => \"Test User $i\",\n"},"line_number":332,"absolute_offset":11050,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'email' => \"testuser$i@ictapproval.test\",\n"},"line_number":333,"absolute_offset":11092,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'phone' => \"0712345678$i\",\n"},"line_number":334,"absolute_offset":11150,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'pf_number' => \"PF12345$i\",\n"},"line_number":335,"absolute_offset":11193,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'password' => bcrypt('password123'),\n"},"line_number":336,"absolute_offset":11237,"submatches":[]}}
{"type":"match","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'department_id' => $department->id ?? null,\n"},"line_number":337,"absolute_offset":11290,"submatches":[{"match":{"text":"department_id' ="},"start":17,"end":33}]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'email_verified_at' => now()\n"},"line_number":338,"absolute_offset":11350,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            ]);\n"},"line_number":339,"absolute_offset":11395,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":340,"absolute_offset":11411,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            // Assign role\n"},"line_number":341,"absolute_offset":11412,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            if ($staffRole) {\n"},"line_number":342,"absolute_offset":11439,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                $user->roles()->attach($staffRole->id);\n"},"line_number":343,"absolute_offset":11469,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            }\n"},"line_number":344,"absolute_offset":11525,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":345,"absolute_offset":11539,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            $testUsers[] = [\n"},"line_number":346,"absolute_offset":11540,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'id' => $user->id,\n"},"line_number":347,"absolute_offset":11569,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'name' => $user->name,\n"},"line_number":348,"absolute_offset":11604,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'email' => $user->email,\n"},"line_number":349,"absolute_offset":11643,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"                'role' => 'staff'\n"},"line_number":350,"absolute_offset":11684,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            ];\n"},"line_number":351,"absolute_offset":11718,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        }\n"},"line_number":352,"absolute_offset":11733,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":353,"absolute_offset":11743,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        return $testUsers;\n"},"line_number":354,"absolute_offset":11744,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    }\n"},"line_number":355,"absolute_offset":11771,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":356,"absolute_offset":11777,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    /**\n"},"line_number":357,"absolute_offset":11778,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"     * Create test bookings\n"},"line_number":358,"absolute_offset":11786,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"     */\n"},"line_number":359,"absolute_offset":11814,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    private function createTestBookings(array $testUsers): array\n"},"line_number":360,"absolute_offset":11822,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"    {\n"},"line_number":361,"absolute_offset":11887,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $testBookings = [];\n"},"line_number":362,"absolute_offset":11893,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $deviceTypes = ['laptop', 'projector', 'monitor', 'keyboard'];\n"},"line_number":363,"absolute_offset":11921,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        $statuses = ['pending', 'approved', 'rejected'];\n"},"line_number":364,"absolute_offset":11992,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"\n"},"line_number":365,"absolute_offset":12049,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"        foreach ($testUsers as $index => $testUser) {\n"},"line_number":366,"absolute_offset":12050,"submatches":[]}}
{"type":"context","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"lines":{"text":"            $booking = BookingService::create([\n"},"line_number":367,"absolute_offset":12104,"submatches":[]}}
{"type":"end","data":{"path":{"text":"backend\\app\\Http\\Controllers\\Api\\v1\\TestICTApprovalController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":93300,"human":"0.000093s"},"searches":1,"searches_with_match":1,"bytes_searched":13156,"bytes_printed":13908,"matched_lines":1,"matches":1}}}
{"data":{"elapsed_total":{"human":"0.165089s","nanos":165088800,"secs":0},"stats":{"bytes_printed":491457,"bytes_searched":212523,"elapsed":{"human":"0.005739s","nanos":5739200,"secs":0},"matched_lines":51,"matches":51,"searches":20,"searches_with_match":20}},"type":"summary"}
